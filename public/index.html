<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Logo Generator</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2385399270661663"
     crossorigin="anonymous"></script>
    <style>
      /* Reset & layout */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        background: #0d0d0d;
        color: #ececec;
        min-height: 100vh;
      }
      .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
      }
      @media (max-width: 768px) {
        .container {
          grid-template-columns: 1fr;
          padding: 20px;
        }
        .hero {
          padding: 40px 20px 30px;
        }
        .hero h1 {
          font-size: 28px;
        }
        .hero .subtitle {
          font-size: 16px;
        }
        .sample-logos {
          gap: 12px;
        }
        .sample-logo {
          width: 110px;
          height: 110px;
          font-size: 12px;
        }
        .progress-steps {
          padding: 16px;
        }
        .step-number {
          width: 32px;
          height: 32px;
          font-size: 14px;
        }
        .step-label {
          font-size: 11px;
        }
      }
      .card {
        background: #171717;
        border: 1px solid #2a2a2a;
        border-radius: 12px;
        padding: 32px;
      }
      .form-card {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }
      .preview-card {
        position: sticky;
        top: 20px;
        height: fit-content;
      }
      h1 {
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #fff;
      }
      .subtitle {
        color: #8e8e93;
        font-size: 14px;
        margin-bottom: 32px;
      }
      .section {
        margin-bottom: 32px;
      }
      .section-title {
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #8e8e93;
        margin-bottom: 16px;
      }
      .form-group {
        margin-bottom: 20px;
      }
      label {
        display: block;
        font-size: 14px;
        font-weight: 500;
        color: #ececec;
        margin-bottom: 8px;
      }
      label.optional {
        color: #8e8e93;
      }
      label.optional::after {
        content: ' (optional)';
        font-weight: 400;
      }
      input[type='text'],
      input[type='email'],
      input[type='password'],
      select {
        width: 100%;
        padding: 12px 16px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        font-size: 15px;
        color: #ececec;
        transition: all 0.2s;
        font-family: inherit;
      }
      input[type='text']:focus,
      input[type='email']:focus,
      input[type='password']:focus,
      select:focus {
        outline: none;
        border-color: #10a37f;
        background: #252525;
      }
      input[type='text']::placeholder,
      input[type='email']::placeholder,
      input[type='password']::placeholder {
        color: #6e6e73;
      }
      .form-group input[type='email'],
      .form-group input[type='password'] {
        margin-top: 0;
      }
      .form-group .field-hint {
        font-size: 12px;
        color: #8e8e93;
        margin-top: 6px;
        line-height: 1.4;
      }
      /* Color pickers */
      .color-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .color-input-wrapper {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      input[type='color'] {
        width: 100%;
        height: 48px;
        padding: 4px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        cursor: pointer;
      }
      /* Button */
      button {
        width: 100%;
        padding: 14px 24px;
        background: #10a37f;
        color: #fff;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        margin-top: 8px;
      }
      button:disabled {
        background: #1a3a2e;
        color: #6e6e73;
        cursor: wait;
      }
      button:hover:enabled {
        background: #0d8a6a;
      }
      button:active:enabled {
        transform: scale(0.98);
      }
      /* Preview */
      .preview {
        text-align: center;
      }
      .preview-placeholder {
        background: #1f1f1f;
        border: 2px dashed #2a2a2a;
        border-radius: 12px;
        padding: 60px 20px;
        color: #6e6e73;
        font-size: 14px;
      }
      .preview img {
        max-width: 100%;
        border-radius: 12px;
        background: #1f1f1f;
        padding: 20px;
      }
      .downloads {
        margin-top: 20px;
        display: flex;
        gap: 12px;
        justify-content: center;
      }
      .downloads a {
        padding: 10px 20px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        color: #ececec;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
      }
      .downloads a:hover {
        background: #252525;
        border-color: #10a37f;
        color: #10a37f;
      }
      .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .error {
        color: #ff453a;
        font-size: 14px;
        margin-top: 8px;
      }
      .suggestions-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 8px;
        margin-top: 12px;
      }
      .suggestion-chip {
        padding: 8px 12px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 6px;
        color: #ececec;
        font-size: 13px;
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
      }
      .suggestion-chip:hover {
        background: #252525;
        border-color: #10a37f;
        color: #10a37f;
      }
      .suggestions-label {
        font-size: 12px;
        color: #8e8e93;
        margin-bottom: 8px;
      }
      #suggestBtn:hover {
        background: #252525;
        border-color: #10a37f;
        color: #10a37f;
      }
      /* Hero Section */
      .hero {
        text-align: center;
        padding: 60px 20px 40px;
        background: linear-gradient(135deg, #171717 0%, #1f1f1f 100%);
        border-bottom: 1px solid #2a2a2a;
      }
      .hero h1 {
        font-size: 42px;
        font-weight: 700;
        margin-bottom: 16px;
        background: linear-gradient(135deg, #10a37f 0%, #0d8a6a 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .hero .subtitle {
        font-size: 18px;
        color: #8e8e93;
        margin-bottom: 32px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }
      .hero-tagline {
        font-size: 16px;
        color: #ececec;
        margin-bottom: 40px;
      }
      .sample-logos {
        display: flex;
        gap: 16px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 32px;
      }
      .sample-logo {
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        padding: 20px;
        width: 140px;
        height: 140px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        color: #ececec;
        text-align: center;
        font-weight: 600;
        transition: transform 0.2s;
      }
      .sample-logo:hover {
        transform: translateY(-4px);
        border-color: #10a37f;
      }
      /* Homepage Styles */
      .homepage {
        min-height: 100vh;
      }
      .hero-gradient {
        background: linear-gradient(135deg, #0d0d0d 0%, #1a1a2e 50%, #0d0d0d 100%);
        position: relative;
        overflow: hidden;
      }
      .hero-gradient::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 30% 20%, rgba(16, 163, 127, 0.15) 0%, transparent 50%);
        pointer-events: none;
      }
      .hero-gradient > div {
        position: relative;
        z-index: 1;
      }
      .hero-cta {
        box-shadow: 0 4px 20px rgba(16, 163, 127, 0.3);
      }
      .features-section {
        background: #171717;
        border-top: 1px solid #2a2a2a;
        padding: 0;
      }
      .tools-showcase-section {
        background: #0d0d0d;
        padding: 0;
      }
      .tool-card {
        background: #171717;
        border: 1px solid #2a2a2a;
        border-radius: 16px;
        padding: 0;
        overflow: hidden;
        transition: all 0.3s;
        cursor: pointer;
      }
      .tool-card:hover {
        border-color: #10a37f;
        transform: translateY(-8px);
        box-shadow: 0 12px 40px rgba(16, 163, 127, 0.2);
      }
      .tool-card-image {
        width: 100%;
        background: #1f1f1f;
        padding: 24px;
        border-bottom: 1px solid #2a2a2a;
      }
      .tool-card h3 {
        padding: 0 24px;
        margin-top: 24px;
        margin-bottom: 12px;
      }
      .tool-card p {
        padding: 0 24px 24px;
      }
      .feature-card {
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 12px;
        padding: 32px;
        text-align: center;
        transition: all 0.3s;
      }
      .feature-card:hover {
        border-color: #10a37f;
        transform: translateY(-4px);
      }
      .feature-icon {
        font-size: 48px;
        margin-bottom: 16px;
      }
      .feature-card h3 {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 12px;
        color: #fff;
      }
      .feature-card p {
        color: #8e8e93;
        font-size: 14px;
        line-height: 1.6;
      }
      .cta-section {
        background: linear-gradient(135deg, #10a37f 0%, #0d8a6a 100%);
        border-radius: 16px;
        padding: 48px 32px;
        margin-top: 48px;
      }
      .cta-button {
        padding: 14px 32px;
        font-size: 16px;
        font-weight: 600;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .cta-button.primary {
        background: #fff;
        color: #10a37f;
      }
      .cta-button.primary:hover {
        background: #f0f0f0;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }
      .cta-button.secondary {
        background: transparent;
        color: #fff;
        border: 2px solid #fff;
      }
      .cta-button.secondary:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      /* Auth Gate Overlay */
      .auth-gate {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(8px);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        pointer-events: none;
      }
      .auth-gate.active {
        display: flex;
        pointer-events: auto;
      }
      .auth-gate-content {
        background: #171717;
        border: 1px solid #2a2a2a;
        border-radius: 16px;
        padding: 48px;
        max-width: 500px;
        text-align: center;
      }
      .auth-gate-content h2 {
        font-size: 28px;
        margin-bottom: 16px;
        color: #fff;
      }
      .auth-gate-content p {
        color: #8e8e93;
        font-size: 16px;
        margin-bottom: 32px;
        line-height: 1.6;
      }
      .auth-gate-buttons {
        display: flex;
        gap: 12px;
        justify-content: center;
      }
      /* Progress Indicator */
      .progress-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 32px;
        padding: 20px;
        background: #1f1f1f;
        border-radius: 8px;
        border: 1px solid #2a2a2a;
      }
      .progress-step {
        flex: 1;
        text-align: center;
        position: relative;
      }
      .progress-step:not(:last-child)::after {
        content: '';
        position: absolute;
        top: 20px;
        right: -50%;
        width: 100%;
        height: 2px;
        background: #2a2a2a;
        z-index: 0;
      }
      .progress-step.active:not(:last-child)::after {
        background: #10a37f;
      }
      .step-number {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #2a2a2a;
        border: 2px solid #2a2a2a;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 8px;
        color: #8e8e93;
        font-weight: 600;
        position: relative;
        z-index: 1;
      }
      .progress-step.active .step-number {
        background: #10a37f;
        border-color: #10a37f;
        color: #fff;
      }
      .progress-step.completed .step-number {
        background: #0d8a6a;
        border-color: #0d8a6a;
        color: #fff;
      }
      .step-label {
        font-size: 12px;
        color: #8e8e93;
      }
      .progress-step.active .step-label {
        color: #ececec;
        font-weight: 500;
      }
      /* Tooltip */
      .tooltip {
        position: relative;
        display: inline-block;
        margin-left: 6px;
        cursor: help;
      }
      .tooltip-icon {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #2a2a2a;
        color: #8e8e93;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        font-weight: 600;
      }
      .tooltip-text {
        visibility: hidden;
        width: 200px;
        background: #1f1f1f;
        color: #ececec;
        text-align: left;
        border-radius: 6px;
        padding: 8px 12px;
        position: absolute;
        z-index: 1000;
        bottom: 125%;
        left: 50%;
        margin-left: -100px;
        opacity: 0;
        transition: opacity 0.3s;
        font-size: 12px;
        line-height: 1.4;
        border: 1px solid #2a2a2a;
      }
      .tooltip:hover .tooltip-text {
        visibility: visible;
        opacity: 1;
      }
      /* Trust Badge */
      .trust-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 6px;
        font-size: 12px;
        color: #8e8e93;
        margin-top: 12px;
      }
      .format-info {
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        padding: 12px;
        margin-top: 12px;
        font-size: 12px;
        color: #8e8e93;
        line-height: 1.5;
      }
      /* Icon Picker */
      .icon-picker-container {
        position: relative;
      }
      .icon-picker-btn {
        padding: 8px 12px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        color: #ececec;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
      }
      .icon-picker-btn:hover {
        background: #252525;
        border-color: #10a37f;
        color: #10a37f;
      }
      .icon-picker-modal {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        margin-top: 8px;
        background: #171717;
        border: 1px solid #2a2a2a;
        border-radius: 12px;
        padding: 20px;
        z-index: 1000;
        width: 320px;
        max-height: 400px;
        overflow-y: auto;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      }
      .icon-picker-modal.active {
        display: block;
      }
      .icon-category {
        margin-bottom: 20px;
      }
      .icon-category-title {
        font-size: 12px;
        font-weight: 600;
        color: #8e8e93;
        text-transform: uppercase;
        margin-bottom: 12px;
        letter-spacing: 0.5px;
      }
      .icon-grid {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 8px;
      }
      .icon-option {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        cursor: pointer;
        font-size: 20px;
        transition: all 0.2s;
      }
      .icon-option:hover {
        background: #252525;
        border-color: #10a37f;
        transform: scale(1.1);
      }
      .icon-option.selected {
        background: #10a37f;
        border-color: #10a37f;
      }
      .icon-input-row {
        display: flex;
        gap: 8px;
        align-items: flex-start;
      }
      /* Auth UI */
      .auth-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: #171717;
        border-bottom: 1px solid #2a2a2a;
        padding: 12px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
      }
      .auth-buttons {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .auth-btn {
        padding: 8px 16px;
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 6px;
        color: #ececec;
        text-decoration: none;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .auth-btn:hover {
        background: #252525;
        border-color: #10a37f;
        color: #10a37f;
      }
      .auth-btn.primary {
        background: #10a37f;
        border-color: #10a37f;
        color: #fff;
      }
      .auth-btn.primary:hover {
        background: #0d8a6a;
      }
      .user-info {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: nowrap;
      }
      .user-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: #10a37f;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-weight: 600;
        font-size: 15px;
        flex-shrink: 0;
        border: 2px solid #2a2a2a;
      }
      .user-details {
        display: flex;
        flex-direction: column;
        gap: 2px;
        min-width: 0;
        flex-shrink: 1;
      }
      .user-name {
        font-size: 14px;
        font-weight: 500;
        color: #ececec;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .usage-info {
        font-size: 11px;
        color: #8e8e93;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      body {
        padding-top: 60px;
      }
      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        z-index: 20000;
        align-items: center;
        justify-content: center;
        pointer-events: none;
      }
      .modal.active {
        display: flex;
        pointer-events: auto;
      }
      .modal-content {
        background: #171717;
        border: 1px solid #2a2a2a;
        border-radius: 12px;
        padding: 32px;
        max-width: 400px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
      }
      .modal-header {
        margin-bottom: 24px;
      }
      .modal-header h2 {
        font-size: 24px;
        margin-bottom: 8px;
      }
      .modal-close {
        float: right;
        background: none;
        border: none;
        color: #8e8e93;
        font-size: 24px;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
      }
      .oauth-buttons {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: 24px;
      }
      .oauth-btn {
        padding: 12px;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        background: #1f1f1f;
        color: #ececec;
        text-decoration: none;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all 0.2s;
      }
      .oauth-btn:hover {
        background: #252525;
        border-color: #10a37f;
      }
      .divider {
        text-align: center;
        margin: 24px 0;
        color: #8e8e93;
        position: relative;
      }
      .divider::before,
      .divider::after {
        content: '';
        position: absolute;
        top: 50%;
        width: 45%;
        height: 1px;
        background: #2a2a2a;
      }
      .divider::before {
        left: 0;
      }
      .divider::after {
        right: 0;
      }
      .error-message {
        background: #2a1f1f;
        border: 1px solid #ff453a;
        color: #ff453a;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 16px;
        font-size: 14px;
      }
      .success-message {
        background: #1f2a1f;
        border: 1px solid #10a37f;
        color: #10a37f;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 16px;
        font-size: 14px;
      }
      /* Ads */
      .ad-container {
        background: #1f1f1f;
        border: 1px solid #2a2a2a;
        border-radius: 8px;
        padding: 20px;
        margin-top: 24px;
        text-align: center;
        min-height: 250px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .ad-label {
        font-size: 11px;
        color: #8e8e93;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 12px;
      }
    </style>
  </head>
  <body>
    <!-- Auth Header -->
    <div class="auth-header">
      <div style="font-weight: 600; color: #10a37f;" data-i18n="app.title">Logo Generator</div>
      <div style="display: flex; align-items: center; gap: 12px;">
        <!-- Language Selector -->
        <select id="languageSelector" onchange="window.i18n.setLanguage(this.value)" style="padding: 6px 10px; background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 6px; color: #ececec; font-size: 12px; cursor: pointer;">
          <option value="en">üá¨üáß English</option>
          <option value="da">üá©üá∞ Dansk</option>
          <option value="sv">üá∏üá™ Svenska</option>
          <option value="de">üá©üá™ Deutsch</option>
          <option value="it">üáÆüáπ Italiano</option>
          <option value="es">üá™üá∏ Espa√±ol</option>
          <option value="fr">üá´üá∑ Fran√ßais</option>
          <option value="nl">üá≥üá± Nederlands</option>
        </select>
        <div class="auth-buttons" id="authButtons">
          <button class="auth-btn" id="loginBtn" data-i18n="auth.login">Log In</button>
          <button class="auth-btn primary" id="signupBtn" data-i18n="auth.signup">Sign Up</button>
        </div>
      </div>
      <div class="user-info" id="userInfo" style="display: none;">
        <div class="user-avatar" id="userAvatar">U</div>
        <div class="user-details">
          <div class="user-name" id="userName">User</div>
          <div class="usage-info" id="usageInfo" data-i18n="usage.loading">Loading...</div>
        </div>
        <button class="auth-btn" onclick="logout()" style="margin-left: 8px;" data-i18n="auth.logout">Logout</button>
      </div>
    </div>

    <!-- Homepage / Landing Page -->
    <div id="homepage" class="homepage" style="display: block;">
      <!-- Hero Section -->
      <div class="hero hero-gradient">
        <div style="max-width: 1200px; margin: 0 auto; padding: 100px 20px 80px; text-align: center;">
          <h1 style="font-size: 56px; font-weight: 700; margin-bottom: 24px; color: #fff; line-height: 1.2;" data-i18n="homepage.hero.title">Logo Generator Online - AI-Powered Design Tools</h1>
          <p class="subtitle" style="font-size: 20px; max-width: 800px; margin: 0 auto 48px; color: #b0b0b0; line-height: 1.6;" data-i18n="homepage.hero.subtitle">Create stunning logos and brand assets online for free. Boost your branding efficiency by 10x with advanced AI, powerful design tools, and seamless exports.</p>
          <div style="display: flex; gap: 16px; justify-content: center; margin-bottom: 60px; flex-wrap: wrap;">
            <button class="cta-button primary hero-cta" id="heroSignupBtn" style="font-size: 18px; padding: 16px 40px;" data-i18n="homepage.cta.signup">Start Free Account</button>
            <button class="cta-button secondary hero-cta" id="heroLoginBtn" style="font-size: 18px; padding: 16px 40px; background: transparent; border: 2px solid #fff; color: #fff;" data-i18n="auth.login">Sign In</button>
          </div>
        </div>
      </div>

      <!-- Tools Showcase Section (ImgLarger Style) -->
      <div class="tools-showcase-section">
        <div style="max-width: 1400px; margin: 0 auto; padding: 80px 20px;">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 32px; margin-bottom: 60px;">
            
            <!-- Logo Generator Card -->
            <div class="tool-card" data-tool-card="true">
              <div class="tool-card-image">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; padding: 16px; background: #1f1f1f; border-radius: 8px; min-height: 200px;">
                  <div class="sample-logo" style="background: #FFF8DC; color: #8B4513; width: 100%; height: 90px; font-size: 12px;">Sweet Dreams<br>Bakery</div>
                  <div class="sample-logo" style="background: #E0F2FE; color: #1E3A8A; width: 100%; height: 90px; font-size: 12px;">Flow Masters<br>Plumbing</div>
                  <div class="sample-logo" style="background: #EFEBE9; color: #5D4037; width: 100%; height: 90px; font-size: 12px;">Green Thumb<br>Landscaping</div>
                  <div class="sample-logo" style="background: #F8BBD0; color: #6A5ACD; width: 100%; height: 90px; font-size: 12px;">Fit Zone<br>Fitness</div>
                </div>
              </div>
              <h3 style="font-size: 22px; font-weight: 600; margin: 24px 0 12px; color: #fff;" data-i18n="homepage.tools.logo.title">AI Logo Generator</h3>
              <p style="color: #8e8e93; font-size: 15px; line-height: 1.6;" data-i18n="homepage.tools.logo.description">Generate professional logos, brand identities, and business graphics instantly.</p>
            </div>

            <!-- Favicon Generator Card -->
            <div class="tool-card" data-tool-card="true">
              <div class="tool-card-image">
                <div style="display: flex; align-items: center; justify-content: center; gap: 16px; padding: 24px; background: #1f1f1f; border-radius: 8px; min-height: 200px;">
                  <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #10a37f, #0d8a6a); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 20px;">AB</div>
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #6366f1, #4f46e5); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 20px;">C</div>
                    <div style="width: 48px; height: 48px; background: #1a1a1a; border: 2px solid #10a37f; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: #10a37f; font-weight: 700; font-size: 20px;">XY</div>
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 20px;">M</div>
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #ec4899, #db2777); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 20px;">Z</div>
                    <div style="width: 48px; height: 48px; background: #0d0d0d; border: 2px solid #6366f1; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #6366f1; font-weight: 700; font-size: 20px;">1</div>
                  </div>
                </div>
              </div>
              <h3 style="font-size: 22px; font-weight: 600; margin: 24px 0 12px; color: #fff;" data-i18n="homepage.tools.favicon.title">AI Favicon Generator</h3>
              <p style="color: #8e8e93; font-size: 15px; line-height: 1.6;" data-i18n="homepage.tools.favicon.description">Create matching favicons for your website in all standard sizes instantly.</p>
            </div>

            <!-- Brand Assets Card -->
            <div class="tool-card" data-tool-card="true">
              <div class="tool-card-image">
                <div style="display: flex; align-items: center; justify-content: center; gap: 20px; padding: 24px; background: #1f1f1f; border-radius: 8px; min-height: 200px;">
                  <div style="text-align: center;">
                    <div style="width: 80px; height: 80px; background: #2a2a2a; border: 2px dashed #10a37f; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px;">
                      <span style="color: #10a37f; font-size: 32px;">SVG</span>
                    </div>
                    <div style="font-size: 12px; color: #8e8e93;">Vector</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="width: 80px; height: 80px; background: #2a2a2a; border: 2px dashed #10a37f; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px;">
                      <span style="color: #10a37f; font-size: 32px;">PNG</span>
                    </div>
                    <div style="font-size: 12px; color: #8e8e93;">Raster</div>
                  </div>
                </div>
              </div>
              <h3 style="font-size: 22px; font-weight: 600; margin: 24px 0 12px; color: #fff;" data-i18n="homepage.tools.formats.title">All Formats Included</h3>
              <p style="color: #8e8e93; font-size: 15px; line-height: 1.6;" data-i18n="homepage.tools.formats.description">Get SVG and PNG files ready for web, print, and social media.</p>
            </div>

            <!-- AI-Powered Design Card -->
            <div class="tool-card" data-tool-card="true">
              <div class="tool-card-image">
                <div style="padding: 24px; background: linear-gradient(135deg, rgba(16, 163, 127, 0.1), rgba(99, 102, 241, 0.1)); border-radius: 8px; min-height: 200px; display: flex; align-items: center; justify-content: center;">
                  <div style="text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 16px;">‚ú®</div>
                    <div style="font-size: 14px; color: #10a37f; font-weight: 600;">AI-Powered</div>
                  </div>
                </div>
              </div>
              <h3 style="font-size: 22px; font-weight: 600; margin: 24px 0 12px; color: #fff;" data-i18n="homepage.tools.ai.title">AI-Powered Design</h3>
              <p style="color: #8e8e93; font-size: 15px; line-height: 1.6;" data-i18n="homepage.tools.ai.description">Create professional logos in minutes with our intelligent design system.</p>
            </div>

            <!-- Full Rights Card -->
            <div class="tool-card" data-tool-card="true">
              <div class="tool-card-image">
                <div style="padding: 24px; background: #1f1f1f; border-radius: 8px; min-height: 200px; display: flex; align-items: center; justify-content: center;">
                  <div style="text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 16px;">üîí</div>
                    <div style="font-size: 14px; color: #10a37f; font-weight: 600;">100% Ownership</div>
                  </div>
                </div>
              </div>
              <h3 style="font-size: 22px; font-weight: 600; margin: 24px 0 12px; color: #fff;" data-i18n="homepage.tools.rights.title">Full Usage Rights</h3>
              <p style="color: #8e8e93; font-size: 15px; line-height: 1.6;" data-i18n="homepage.tools.rights.description">You own your logo completely ‚Äî use it anywhere, anytime.</p>
            </div>

            <!-- Lightning Fast Card -->
            <div class="tool-card" data-tool-card="true">
              <div class="tool-card-image">
                <div style="padding: 24px; background: linear-gradient(135deg, rgba(16, 163, 127, 0.1), rgba(16, 163, 127, 0.05)); border-radius: 8px; min-height: 200px; display: flex; align-items: center; justify-content: center;">
                  <div style="text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 16px;">‚ö°</div>
                    <div style="font-size: 14px; color: #10a37f; font-weight: 600;">Instant Generation</div>
                  </div>
                </div>
              </div>
              <h3 style="font-size: 22px; font-weight: 600; margin: 24px 0 12px; color: #fff;" data-i18n="homepage.tools.fast.title">Lightning Fast</h3>
              <p style="color: #8e8e93; font-size: 15px; line-height: 1.6;" data-i18n="homepage.tools.fast.description">Generate your logo instantly ‚Äî no waiting, no delays.</p>
            </div>

          </div>

          <!-- All Tools CTA Button -->
          <div style="text-align: center;">
            <button class="cta-button primary" id="allToolsBtn" style="font-size: 18px; padding: 18px 48px; min-width: 300px;" data-i18n="homepage.tools.allTools">All Logo Design Tools</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Logo Generator (Hidden until authenticated) -->
    <div id="logoGenerator" class="logo-generator" style="display: none;">
      <div class="hero">
        <h1 data-i18n="app.tagline">Create Your Professional Logo in Minutes</h1>
        <p class="subtitle" data-i18n="app.subtitle">No design skills needed ‚Äî perfect for caf√©s, freelancers, artisans, and new small businesses</p>
        <p class="hero-tagline" data-i18n="app.features">‚úì Professional quality ‚úì Full usage rights ‚úì Multiple formats</p>
        <div class="sample-logos">
          <div class="sample-logo" style="background: #FFF8DC; color: #8B4513;">Sweet Dreams<br>Bakery</div>
          <div class="sample-logo" style="background: #E0F2FE; color: #1E3A8A;">Flow Masters<br>Plumbing</div>
          <div class="sample-logo" style="background: #EFEBE9; color: #5D4037;">Green Thumb<br>Landscaping</div>
          <div class="sample-logo" style="background: #F8BBD0; color: #6A5ACD;">Fit Zone<br>Fitness</div>
        </div>
      </div>

      <div class="container">
        <div class="card form-card">
        <div class="progress-steps" id="progressSteps">
          <div class="progress-step active" data-step="1">
            <div class="step-number">1</div>
            <div class="step-label" data-i18n="progress.step1">Business Info</div>
          </div>
          <div class="progress-step" data-step="2">
            <div class="step-number">2</div>
            <div class="step-label" data-i18n="progress.step2">Style & Design</div>
          </div>
          <div class="progress-step" data-step="3">
            <div class="step-number">3</div>
            <div class="step-label" data-i18n="progress.step3">Preview & Download</div>
          </div>
          <div class="progress-step" data-step="4">
            <div class="step-number">4</div>
            <div class="step-label" data-i18n="progress.step4">Favicon</div>
          </div>
        </div>

        <div>
          <h1 style="font-size: 24px; margin-bottom: 8px;" data-i18n="service.title">Small Business Service</h1>
          <p class="subtitle" style="margin-bottom: 0;" data-i18n="service.subtitle">Create your business logo and get started with a digital playbook</p>
        </div>

        <div class="section">
          <div class="section-title" data-i18n="section.textContent">Text Content</div>
          <div class="form-group">
            <label for="businessType" class="optional" data-i18n="form.businessType">
              Business Type
              <span class="tooltip">
                <span class="tooltip-icon">?</span>
                <span class="tooltip-text" data-i18n="form.businessTypeTooltip">Select your business type to get tailored suggestions for icons, colors, and styles</span>
              </span>
            </label>
            <select id="businessType">
              <option value="" data-i18n="option.businessType.select">Select a business type...</option>
              <option value="bakery" data-i18n="option.businessType.bakery">Bakery</option>
              <option value="hairdresser" data-i18n="option.businessType.hairdresser">Hairdresser / Salon</option>
              <option value="plumber" data-i18n="option.businessType.plumber">Plumber</option>
              <option value="electrician" data-i18n="option.businessType.electrician">Electrician</option>
              <option value="restaurant" data-i18n="option.businessType.restaurant">Restaurant / Cafe</option>
              <option value="fitness" data-i18n="option.businessType.fitness">Fitness / Gym</option>
              <option value="photography" data-i18n="option.businessType.photography">Photography</option>
              <option value="consulting" data-i18n="option.businessType.consulting">Consulting</option>
              <option value="retail" data-i18n="option.businessType.retail">Retail / Shop</option>
              <option value="cleaning" data-i18n="option.businessType.cleaning">Cleaning Service</option>
              <option value="landscaping" data-i18n="option.businessType.landscaping">Landscaping</option>
              <option value="automotive" data-i18n="option.businessType.automotive">Automotive</option>
              <option value="real-estate" data-i18n="option.businessType.realEstate">Real Estate</option>
              <option value="tech" data-i18n="option.businessType.tech">Technology</option>
              <option value="healthcare" data-i18n="option.businessType.healthcare">Healthcare</option>
              <option value="education" data-i18n="option.businessType.education">Education / Tutoring</option>
            </select>
          </div>
          <div class="form-group">
            <label for="name" data-i18n="form.businessName">Business Name</label>
            <div style="display: flex; gap: 8px; align-items: flex-start;">
              <input id="name" type="text" data-i18n="form.businessNamePlaceholder" placeholder="Enter your business name" required style="flex: 1; min-width: 0;" />
              <button type="button" id="suggestBtn" data-i18n="form.suggest" style="padding: 8px 10px; width: 70px; flex-shrink: 0; margin: 0; background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; color: #ececec; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s;">Suggest</button>
            </div>
            <div id="suggestions" style="display: none; margin-top: 12px;"></div>
          </div>
          <div class="form-group">
            <label for="tagline" class="optional" data-i18n="form.tagline">Tagline</label>
            <div style="display: flex; gap: 8px; align-items: flex-start;">
              <input id="tagline" type="text" data-i18n="form.taglinePlaceholder" placeholder="Enter a tagline" style="flex: 1; min-width: 0;" />
              <button type="button" id="suggestTaglineBtn" data-i18n="form.suggest" style="padding: 8px 10px; width: 70px; flex-shrink: 0; margin: 0; background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; color: #ececec; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s;">Suggest</button>
            </div>
            <div id="taglineSuggestions" style="display: none; margin-top: 12px;"></div>
          </div>
          <div class="form-group">
            <label for="location" class="optional" data-i18n="form.location">Location</label>
            <input id="location" type="text" data-i18n="form.locationPlaceholder" placeholder="Detecting your location..." />
          </div>
        </div>

        <div class="section">
          <div class="section-title" data-i18n="section.styleTypography">Style & Typography</div>
          <div class="form-group">
            <label for="style" data-i18n="form.style">
              Style
              <span class="tooltip">
                <span class="tooltip-icon">?</span>
                <span class="tooltip-text" data-i18n="form.styleTooltip">Choose a style that matches your brand personality. Minimal = modern, Playful = fun, Corporate = professional</span>
              </span>
            </label>
            <select id="style">
              <option value="minimal" data-i18n="option.style.minimal">Minimal</option>
              <option value="modern" data-i18n="option.style.modern">Modern</option>
              <option value="vintage" data-i18n="option.style.vintage">Vintage</option>
              <option value="luxury" data-i18n="option.style.luxury">Luxury</option>
              <option value="tech" data-i18n="option.style.tech">Tech</option>
              <option value="organic" data-i18n="option.style.organic">Organic</option>
              <option value="corporate" data-i18n="option.style.corporate">Corporate</option>
              <option value="playful" data-i18n="option.style.playful">Playful</option>
              <option value="digital" data-i18n="option.style.digital">Digital</option>
              <option value="handwritten" data-i18n="option.style.handwritten">Handwritten</option>
            </select>
          </div>
          <div class="form-group">
            <label for="fontCategory" data-i18n="form.fontCategory">Font Category</label>
            <select id="fontCategory">
              <option value="modern" data-i18n="option.fontCategory.modern">Modern</option>
              <option value="serif" data-i18n="option.fontCategory.serif">Serif</option>
              <option value="handwritten" data-i18n="option.fontCategory.handwritten">Handwritten</option>
              <option value="bold" data-i18n="option.fontCategory.bold">Bold / Strong</option>
              <option value="elegant" data-i18n="option.fontCategory.elegant">Elegant</option>
              <option value="retro" data-i18n="option.fontCategory.retro">Retro</option>
            </select>
          </div>
        </div>

        <div class="section">
          <div class="section-title" data-i18n="section.iconLayout">Icon & Layout</div>
          <div class="form-group">
            <label for="icon" class="optional" data-i18n="form.icon">
              Icon
              <span class="tooltip">
                <span class="tooltip-icon">?</span>
                <span class="tooltip-text" data-i18n="form.iconTooltip">Choose an icon to add visual interest to your logo. Icons work great for branding!</span>
              </span>
            </label>
            <div class="icon-input-row">
              <input id="icon" type="text" data-i18n="form.iconPlaceholder" placeholder="Select an icon below or type emoji" maxlength="2" style="flex: 1; min-width: 0;" />
              <button type="button" id="iconPickerBtn" class="icon-picker-btn" data-i18n="form.browseIcons">Browse Icons</button>
            </div>
            <div class="icon-picker-container">
              <div class="icon-picker-modal" id="iconPickerModal">
                <div class="icon-category">
                  <div class="icon-category-title" data-i18n="iconCategory.foodDrink">Food & Drink</div>
                  <div class="icon-grid">
                    <div class="icon-option" data-icon="‚òï">‚òï</div>
                    <div class="icon-option" data-icon="üçï">üçï</div>
                    <div class="icon-option" data-icon="üç∞">üç∞</div>
                    <div class="icon-option" data-icon="ü•ê">ü•ê</div>
                    <div class="icon-option" data-icon="üçî">üçî</div>
                    <div class="icon-option" data-icon="ü•ó">ü•ó</div>
                  </div>
                </div>
                <div class="icon-category">
                  <div class="icon-category-title" data-i18n="iconCategory.businessServices">Business & Services</div>
                  <div class="icon-grid">
                    <div class="icon-option" data-icon="üíº">üíº</div>
                    <div class="icon-option" data-icon="üîß">üîß</div>
                    <div class="icon-option" data-icon="‚ö°">‚ö°</div>
                    <div class="icon-option" data-icon="üè†">üè†</div>
                    <div class="icon-option" data-icon="üöó">üöó</div>
                    <div class="icon-option" data-icon="üíá">üíá</div>
                  </div>
                </div>
                <div class="icon-category">
                  <div class="icon-category-title" data-i18n="iconCategory.natureHealth">Nature & Health</div>
                  <div class="icon-grid">
                    <div class="icon-option" data-icon="üåø">üåø</div>
                    <div class="icon-option" data-icon="üå±">üå±</div>
                    <div class="icon-option" data-icon="üíö">üíö</div>
                    <div class="icon-option" data-icon="üèãÔ∏è">üèãÔ∏è</div>
                    <div class="icon-option" data-icon="üßò">üßò</div>
                    <div class="icon-option" data-icon="üå≥">üå≥</div>
                  </div>
                </div>
                <div class="icon-category">
                  <div class="icon-category-title" data-i18n="iconCategory.creativeTech">Creative & Tech</div>
                  <div class="icon-grid">
                    <div class="icon-option" data-icon="üì∏">üì∏</div>
                    <div class="icon-option" data-icon="üé®">üé®</div>
                    <div class="icon-option" data-icon="üíª">üíª</div>
                    <div class="icon-option" data-icon="üöÄ">üöÄ</div>
                    <div class="icon-option" data-icon="‚≠ê">‚≠ê</div>
                    <div class="icon-option" data-icon="‚ú®">‚ú®</div>
                  </div>
                </div>
                <div class="icon-category">
                  <div class="icon-category-title" data-i18n="iconCategory.symbolsShapes">Symbols & Shapes</div>
                  <div class="icon-grid">
                    <div class="icon-option" data-icon="‚ù§Ô∏è">‚ù§Ô∏è</div>
                    <div class="icon-option" data-icon="üíé">üíé</div>
                    <div class="icon-option" data-icon="üî•">üî•</div>
                    <div class="icon-option" data-icon="üåü">üåü</div>
                    <div class="icon-option" data-icon="üéØ">üéØ</div>
                    <div class="icon-option" data-icon="üí´">üí´</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="layout" data-i18n="form.iconPosition">Icon Position</label>
            <select id="layout">
              <option value="none" data-i18n="option.layout.none">None</option>
              <option value="left" data-i18n="option.layout.left">Left</option>
              <option value="top" data-i18n="option.layout.top">Top</option>
            </select>
          </div>
        </div>

        <div class="section">
          <div class="section-title" data-i18n="section.shapeColors">Shape & Colors</div>
          <div class="form-group">
            <label for="shape" data-i18n="form.shape">
              Shape
              <span class="tooltip">
                <span class="tooltip-icon">?</span>
                <span class="tooltip-text" data-i18n="form.shapeTooltip">Choose a shape for your logo background. Circle and Square work great for social media profiles</span>
              </span>
            </label>
            <select id="shape">
              <option value="none" data-i18n="option.shape.none">No Shape (Transparent)</option>
              <option value="circle" data-i18n="option.shape.circle">Circle</option>
              <option value="square" data-i18n="option.shape.square">Square</option>
              <option value="rounded" data-i18n="option.shape.rounded">Rounded Rectangle</option>
            </select>
          </div>
          <div class="form-group">
            <label for="colorPalette" data-i18n="form.colorPalette">Color Palette</label>
            <select id="colorPalette">
              <option value="custom" data-i18n="option.colorPalette.custom">Custom</option>
              <option value="warm" data-i18n="option.colorPalette.warm">Warm</option>
              <option value="cold" data-i18n="option.colorPalette.cold">Cold</option>
              <option value="earthy" data-i18n="option.colorPalette.earthy">Earthy</option>
              <option value="bold" data-i18n="option.colorPalette.bold">Bold</option>
              <option value="pastel" data-i18n="option.colorPalette.pastel">Pastel</option>
              <option value="monochrome" data-i18n="option.colorPalette.monochrome">Monochrome</option>
            </select>
          </div>
          <div id="colorPickers" class="form-group">
            <div class="color-group">
              <div class="color-input-wrapper">
                <label for="fontColor" data-i18n="form.fontColor">Font Color</label>
                <input id="fontColor" type="color" value="#000000" />
              </div>
              <div class="color-input-wrapper">
                <label for="bgColor" data-i18n="form.background">Background</label>
                <input id="bgColor" type="color" value="#ffffff" />
              </div>
            </div>
          </div>
        </div>

        <button id="generateBtn" data-i18n="form.generateLogo">Generate Logo</button>

        <div class="section" style="margin-top: 32px; padding-top: 32px; border-top: 1px solid #2a2a2a;">
          <div class="section-title" data-i18n="nextSteps.title">What's Next?</div>
          <div style="display: grid; gap: 12px;">
            <div style="background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px;">
              <h3 style="font-size: 15px; font-weight: 600; margin-bottom: 8px; color: #ececec;" data-i18n="nextSteps.digitalPlaybook">üìã Digital Playbook</h3>
              <p style="font-size: 13px; color: #8e8e93; margin-bottom: 12px; line-height: 1.4;" data-i18n="nextSteps.digitalPlaybookDesc">
                Get a personalized business plan and digital strategy.
              </p>
              <button type="button" id="createPlaybookBtn" data-i18n="nextSteps.createPlaybook" style="width: 100%; padding: 10px 16px; background: #10a37f; color: #fff; border: none; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                Create Playbook
              </button>
            </div>
            <div style="background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px;">
              <h3 style="font-size: 15px; font-weight: 600; margin-bottom: 8px; color: #ececec;" data-i18n="nextSteps.websiteHosting">üåê Website & Hosting</h3>
              <p style="font-size: 13px; color: #8e8e93; margin-bottom: 12px; line-height: 1.4;" data-i18n="nextSteps.websiteHostingDesc">
                Get your business online with a professional website.
              </p>
              <button type="button" data-i18n="nextSteps.getStarted" style="width: 100%; padding: 10px 16px; background: #1f1f1f; border: 1px solid #2a2a2a; color: #ececec; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s;" onclick="alert('Website builder coming soon!')">
                Get Started
              </button>
            </div>
            <div style="background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px;">
              <h3 style="font-size: 15px; font-weight: 600; margin-bottom: 8px; color: #ececec;" data-i18n="nextSteps.socialMediaKit">üì± Social Media Kit</h3>
              <p style="font-size: 13px; color: #8e8e93; margin-bottom: 12px; line-height: 1.4;" data-i18n="nextSteps.socialMediaKitDesc">
                Business cards, social profiles, and brand guidelines.
              </p>
              <button type="button" data-i18n="nextSteps.learnMore" style="width: 100%; padding: 10px 16px; background: #1f1f1f; border: 1px solid #2a2a2a; color: #ececec; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s;" onclick="alert('Social media kit coming soon!')">
                Learn More
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="card preview-card">
        <div class="section">
          <div class="section-title" data-i18n="section.preview">Preview</div>
          <div class="preview" id="preview">
            <div class="preview-placeholder" data-i18n="preview.placeholder">
              Your logo will appear here
            </div>
          </div>
        </div>
        
        <!-- Ad Container (shown for free tier users) -->
        <div id="adContainer" style="display: none;">
          <div class="ad-label" data-i18n="advertisement.label">Advertisement</div>
          <div class="ad-container" id="adSenseContainer">
            <!-- Google AdSense will be inserted here -->
            <div style="color: #8e8e93; font-size: 12px;" data-i18n="advertisement.placeholder">
              Ad space reserved for free tier users
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Favicon Generator Section (Step 4) -->
    <div class="container" id="faviconSection" style="display: none; margin-top: 48px;">
      <div class="card form-card">
        <div>
          <h1 style="font-size: 24px; margin-bottom: 8px;" data-i18n="favicon.title">Create Your Favicon</h1>
          <p class="subtitle" style="margin-bottom: 24px;" data-i18n="favicon.subtitle">Generate a professional favicon for your website</p>
        </div>

        <!-- Option to use logo -->
        <div class="section" id="faviconUseLogoSection" style="display: none;">
          <div class="section-title" data-i18n="favicon.useLogo.title">Use Your Logo</div>
          <div style="background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
              <div id="faviconLogoPreview" style="width: 64px; height: 64px; border: 1px solid #2a2a2a; border-radius: 4px; display: flex; align-items: center; justify-content: center; background: #0d0d0d; flex-shrink: 0;">
                <span style="color: #8e8e93; font-size: 12px;" data-i18n="favicon.useLogo.preview">Logo</span>
              </div>
              <div style="flex: 1;">
                <p style="font-size: 14px; color: #ececec; margin-bottom: 4px;" data-i18n="favicon.useLogo.description">Create a favicon from your generated logo</p>
                <p style="font-size: 12px; color: #8e8e93;" data-i18n="favicon.useLogo.hint">We'll automatically resize and optimize your logo for all favicon sizes</p>
              </div>
            </div>
            <button type="button" id="useLogoForFaviconBtn" style="width: 100%; padding: 10px; background: #10a37f; color: #fff; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer;" data-i18n="favicon.useLogo.button">Use Logo for Favicon</button>
          </div>
        </div>

        <!-- Auto-generate options -->
        <div class="section">
          <div class="section-title" data-i18n="favicon.autoGenerate.title">Or Create Automatically</div>
          <p style="font-size: 13px; color: #8e8e93; margin-bottom: 16px;" data-i18n="favicon.autoGenerate.description">We'll create creative favicon options based on your business name and type</p>
          <div id="faviconAutoOptions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 16px;">
            <!-- Auto-generated options will appear here -->
          </div>
          <button type="button" id="generateAutoFaviconBtn" style="width: 100%; padding: 10px; background: #1f1f1f; border: 1px solid #2a2a2a; color: #ececec; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer;" data-i18n="favicon.autoGenerate.button">Generate Auto Options</button>
        </div>

        <!-- Manual creation -->
        <div class="section" id="faviconManualSection" style="display: none;">
          <div class="section-title" data-i18n="favicon.manual.title">Or Create Manually</div>
          
          <div class="form-group">
            <label for="faviconText" data-i18n="favicon.text">Text (1-2 characters)</label>
            <input id="faviconText" type="text" maxlength="2" placeholder="AB" style="text-transform: uppercase;" />
            <div class="field-hint" data-i18n="favicon.textHint">Enter 1-2 letters or characters for your favicon</div>
          </div>

          <div class="form-group">
            <label for="faviconStyle" data-i18n="favicon.style">Style</label>
            <select id="faviconStyle">
              <option value="minimal" data-i18n="favicon.style.minimal">Minimalistic</option>
              <option value="flat" data-i18n="favicon.style.flat">Flat</option>
              <option value="gradient" data-i18n="favicon.style.gradient">Gradient</option>
              <option value="outline" data-i18n="favicon.style.outline">Outline</option>
              <option value="material" data-i18n="favicon.style.material">Material Design</option>
            </select>
          </div>

          <div class="form-group">
            <label for="faviconFontCategory" data-i18n="form.fontCategory">Font Category</label>
            <select id="faviconFontCategory">
              <option value="modern" data-i18n="option.fontCategory.modern">Modern</option>
              <option value="serif" data-i18n="option.fontCategory.serif">Serif</option>
              <option value="handwritten" data-i18n="option.fontCategory.handwritten">Handwritten</option>
              <option value="bold" data-i18n="option.fontCategory.bold">Bold / Strong</option>
              <option value="elegant" data-i18n="option.fontCategory.elegant">Elegant</option>
              <option value="retro" data-i18n="option.fontCategory.retro">Retro</option>
            </select>
          </div>

          <div class="form-group">
            <label for="faviconShape" data-i18n="form.shape">Shape</label>
            <select id="faviconShape">
              <option value="square" data-i18n="option.shape.square">Square</option>
              <option value="rounded" data-i18n="option.shape.rounded">Rounded Square</option>
              <option value="circle" data-i18n="option.shape.circle">Circle</option>
              <option value="squircle" data-i18n="favicon.shape.squircle">Squircle</option>
              <option value="none" data-i18n="option.shape.none">Transparent</option>
            </select>
          </div>

          <div class="section">
            <div class="section-title" data-i18n="section.shapeColors">Colors</div>
            <div id="faviconColorPickers" class="form-group">
              <div class="color-group">
                <div class="color-input-wrapper">
                  <label for="faviconFontColor" data-i18n="form.fontColor">Font Color</label>
                  <input id="faviconFontColor" type="color" value="#ffffff" />
                </div>
                <div class="color-input-wrapper">
                  <label for="faviconBgColor" data-i18n="form.background">Background</label>
                  <input id="faviconBgColor" type="color" value="#10a37f" />
                </div>
              </div>
            </div>
          </div>

          <button id="generateFaviconBtn" data-i18n="favicon.generate">Generate Favicon</button>
        </div>

        <!-- Show manual option toggle -->
        <div style="text-align: center; margin-top: 16px;">
          <button type="button" id="toggleManualFaviconBtn" style="background: none; border: none; color: #10a37f; font-size: 13px; cursor: pointer; text-decoration: underline;" data-i18n="favicon.manual.toggle">Create manually instead</button>
        </div>

        <!-- Preview section -->
        <div class="section" id="faviconPreviewSection" style="display: none; margin-top: 32px; padding-top: 32px; border-top: 1px solid #2a2a2a;">
          <div class="section-title" data-i18n="favicon.preview.title">Your Favicons</div>
          <div id="faviconPreview" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 16px;">
            <!-- Favicon previews will be inserted here -->
          </div>
          <div style="margin-top: 24px; padding: 16px; background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px;">
            <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 12px; color: #ececec;" data-i18n="favicon.instructions.title">How to Use Your Favicons</h4>
            <p style="font-size: 13px; color: #8e8e93; line-height: 1.6; margin-bottom: 12px;" data-i18n="favicon.instructions.description">
              Add these files to your website's root directory and include the following code in your HTML &lt;head&gt; section:
            </p>
            <pre id="faviconHtmlCode" style="background: #0d0d0d; padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 12px; color: #10a37f; font-family: 'Courier New', monospace; margin: 0;"></pre>
            <button type="button" id="downloadAllFaviconsBtn" style="width: 100%; margin-top: 12px; padding: 10px; background: #10a37f; color: #fff; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; display: none;" data-i18n="favicon.downloadAll">Download All as ZIP</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Auth Gate Overlay -->
    <div id="authGate" class="auth-gate">
      <div class="auth-gate-content">
        <h2 data-i18n="authGate.title">Sign Up to Get Started</h2>
        <p data-i18n="authGate.description">Create a free account to start generating professional logos and favicons for your business</p>
        <div class="auth-gate-buttons">
          <button class="cta-button primary" onclick="if(typeof window.openSignupModal === 'function') { window.openSignupModal(); window.closeAuthGate(); }" data-i18n="authGate.signup">Sign Up Free</button>
          <button class="cta-button secondary" onclick="if(typeof window.openLoginModal === 'function') { window.openLoginModal(); window.closeAuthGate(); }" data-i18n="authGate.login">Log In</button>
        </div>
        <button onclick="if(typeof window.closeAuthGate === 'function') { window.closeAuthGate(); }" style="margin-top: 24px; background: none; border: none; color: #8e8e93; font-size: 14px; cursor: pointer; text-decoration: underline;" data-i18n="authGate.close">Maybe later</button>
      </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
      <div class="modal-content">
        <div class="modal-header">
          <button class="modal-close" onclick="if(typeof window.closeLoginModal === 'function') { window.closeLoginModal(); }">&times;</button>
          <h2 data-i18n="auth.login">Log In</h2>
          <p class="subtitle" data-i18n="auth.signInToAccount">Sign in to your account</p>
        </div>
        <div id="loginError"></div>
        <div class="oauth-buttons">
          <a href="/auth/google" class="oauth-btn" data-i18n="auth.continueWithGoogle">Continue with Google</a>
          <a href="/auth/facebook" class="oauth-btn" data-i18n="auth.continueWithFacebook">Continue with Facebook</a>
        </div>
        <div class="divider" data-i18n="modal.or">or</div>
        <form id="loginForm" onsubmit="handleLogin(event)">
          <div class="form-group">
            <label for="loginEmail" data-i18n="auth.email">Email</label>
            <input type="email" id="loginEmail" data-i18n="auth.emailPlaceholder" placeholder="Enter your email" required />
          </div>
          <div class="form-group">
            <label for="loginPassword" data-i18n="auth.password">Password</label>
            <input type="password" id="loginPassword" data-i18n="auth.passwordPlaceholder" placeholder="Enter your password" required />
          </div>
          <button type="submit" class="auth-btn primary" style="width: 100%; margin-top: 8px;" data-i18n="auth.login">Log In</button>
        </form>
        <div style="text-align: center; margin-top: 16px;">
          <a href="#" onclick="if(typeof window.openForgotPasswordModal === 'function' && typeof window.closeLoginModal === 'function') { window.openForgotPasswordModal(); window.closeLoginModal(); }" style="color: #10a37f; font-size: 14px;" data-i18n="auth.forgotPassword">Forgot password?</a>
        </div>
        <div style="text-align: center; margin-top: 16px; font-size: 14px; color: #8e8e93;">
          <span data-i18n="auth.dontHaveAccount">Don't have an account?</span> <a href="#" onclick="if(typeof window.closeLoginModal === 'function' && typeof window.openSignupModal === 'function') { window.closeLoginModal(); window.openSignupModal(); }" style="color: #10a37f;" data-i18n="auth.signup">Sign up</a>
        </div>
      </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
      <div class="modal-content">
        <div class="modal-header">
          <button class="modal-close" onclick="if(typeof window.closeSignupModal === 'function') { window.closeSignupModal(); }">&times;</button>
          <h2>Sign Up</h2>
          <p class="subtitle">Create your free account</p>
        </div>
        <div id="signupError"></div>
        <div class="oauth-buttons">
          <a href="/auth/google" class="oauth-btn">Continue with Google</a>
          <a href="/auth/facebook" class="oauth-btn">Continue with Facebook</a>
        </div>
        <div class="divider">or</div>
        <form id="signupForm" onsubmit="handleSignup(event)">
          <div class="form-group">
            <label for="signupName" class="optional">Name</label>
            <input type="text" id="signupName" placeholder="Enter your name (optional)" />
          </div>
          <div class="form-group">
            <label for="signupEmail">Email</label>
            <input type="email" id="signupEmail" placeholder="Enter your email" required />
          </div>
          <div class="form-group">
            <label for="signupPassword">Password</label>
            <input type="password" id="signupPassword" placeholder="Enter your password" required minlength="8" />
            <div class="field-hint">Must be at least 8 characters</div>
          </div>
          <button type="submit" class="auth-btn primary" style="width: 100%; margin-top: 8px;">Sign Up</button>
        </form>
        <div style="text-align: center; margin-top: 16px; font-size: 14px; color: #8e8e93;">
          Already have an account? <a href="#" onclick="if(typeof window.closeSignupModal === 'function' && typeof window.openLoginModal === 'function') { window.closeSignupModal(); window.openLoginModal(); }" style="color: #10a37f;">Log in</a>
        </div>
      </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal" id="forgotPasswordModal">
      <div class="modal-content">
        <div class="modal-header">
          <button class="modal-close" onclick="if(typeof window.closeForgotPasswordModal === 'function') { window.closeForgotPasswordModal(); }">&times;</button>
          <h2 data-i18n="auth.resetPassword">Reset Password</h2>
          <p class="subtitle" data-i18n="auth.resetPasswordSubtitle">Enter your email to receive a reset link</p>
        </div>
        <div id="forgotPasswordError"></div>
        <form id="forgotPasswordForm" onsubmit="handleForgotPassword(event)">
          <div class="form-group">
            <label for="forgotPasswordEmail" data-i18n="auth.email">Email</label>
            <input type="email" id="forgotPasswordEmail" data-i18n="auth.emailPlaceholder" placeholder="Enter your email" required />
          </div>
          <button type="submit" class="auth-btn primary" style="width: 100%; margin-top: 8px;" data-i18n="auth.sendResetLink">Send Reset Link</button>
        </form>
      </div>
    </div>

    <!-- i18n System -->
    <script src="/i18n.js"></script>
    
    <!-- Inline JavaScript to avoid separate file request -->
    <script>
      // Define global functions IMMEDIATELY so they're available for onclick handlers
      window.openLoginModal = function() {
        console.log('üîµ openLoginModal called');
        const modal = document.getElementById('loginModal');
        if (!modal) {
          console.error('‚ùå Login modal not found');
          return;
        }
        console.log('‚úÖ Opening login modal');
        modal.classList.add('active');
        console.log('Modal classes:', modal.className);
        console.log('Modal computed display:', window.getComputedStyle(modal).display);
        console.log('Modal z-index:', window.getComputedStyle(modal).zIndex);
        const errorDiv = document.getElementById('loginError');
        if (errorDiv) errorDiv.innerHTML = '';
        if (typeof window.closeAuthGate === 'function') {
          window.closeAuthGate();
        }
      };

      window.closeLoginModal = function() {
        const modal = document.getElementById('loginModal');
        if (modal) {
          modal.classList.remove('active');
          const form = document.getElementById('loginForm');
          if (form) form.reset();
        }
      };

      window.openSignupModal = function() {
        console.log('üü¢ openSignupModal called');
        const modal = document.getElementById('signupModal');
        if (!modal) {
          console.error('‚ùå Signup modal not found');
          return;
        }
        console.log('‚úÖ Opening signup modal');
        modal.classList.add('active');
        console.log('Modal classes:', modal.className);
        console.log('Modal computed display:', window.getComputedStyle(modal).display);
        console.log('Modal z-index:', window.getComputedStyle(modal).zIndex);
        const errorDiv = document.getElementById('signupError');
        if (errorDiv) errorDiv.innerHTML = '';
        if (typeof window.closeAuthGate === 'function') {
          window.closeAuthGate();
        }
      };

      window.closeSignupModal = function() {
        const modal = document.getElementById('signupModal');
        if (modal) {
          modal.classList.remove('active');
          const form = document.getElementById('signupForm');
          if (form) form.reset();
        }
      };

      window.showAuthGate = function() {
        console.log('üü° showAuthGate called');
        const authGate = document.getElementById('authGate');
        if (authGate) {
          console.log('‚úÖ Showing auth gate');
          authGate.classList.add('active');
        } else {
          console.error('‚ùå Auth gate not found');
        }
      };

      window.closeAuthGate = function() {
        const authGate = document.getElementById('authGate');
        if (authGate) {
          authGate.classList.remove('active');
        }
      };

      window.openForgotPasswordModal = function() {
        const modal = document.getElementById('forgotPasswordModal');
        if (modal) {
          modal.classList.add('active');
          const errorDiv = document.getElementById('forgotPasswordError');
          if (errorDiv) errorDiv.innerHTML = '';
        }
      };

      window.closeForgotPasswordModal = function() {
        const modal = document.getElementById('forgotPasswordModal');
        if (modal) {
          modal.classList.remove('active');
          const form = document.getElementById('forgotPasswordForm');
          if (form) form.reset();
        }
      };
      
      // Log that functions are defined
      console.log('‚úÖ Modal functions defined:', {
        openLoginModal: typeof window.openLoginModal,
        openSignupModal: typeof window.openSignupModal,
        showAuthGate: typeof window.showAuthGate,
        closeAuthGate: typeof window.closeAuthGate
      });
      
      // Test if functions can be called directly
      console.log('üß™ Testing function accessibility...');
      try {
        if (typeof window.openLoginModal === 'function') {
          console.log('‚úÖ window.openLoginModal is accessible');
        } else {
          console.error('‚ùå window.openLoginModal is NOT accessible');
        }
      } catch (e) {
        console.error('‚ùå Error testing functions:', e);
      }

      const nameInput = document.getElementById('name');
      const taglineInput = document.getElementById('tagline');
      const locationInput = document.getElementById('location');
      const businessTypeSelect = document.getElementById('businessType');
      const suggestBtn = document.getElementById('suggestBtn');
      const suggestTaglineBtn = document.getElementById('suggestTaglineBtn');
      const suggestionsDiv = document.getElementById('suggestions');
      const taglineSuggestionsDiv = document.getElementById('taglineSuggestions');
      const createPlaybookBtn = document.getElementById('createPlaybookBtn');
      const styleSelect = document.getElementById('style');
      const fontCategorySelect = document.getElementById('fontCategory');
      const iconInput = document.getElementById('icon');
      const iconPickerBtn = document.getElementById('iconPickerBtn');
      const iconPickerModal = document.getElementById('iconPickerModal');
      const layoutSelect = document.getElementById('layout');
      const shapeSelect = document.getElementById('shape');
      const colorPaletteSelect = document.getElementById('colorPalette');
      const fontColorInp = document.getElementById('fontColor');
      const bgColorInp = document.getElementById('bgColor');
      const colorPickersDiv = document.getElementById('colorPickers');
      const btn = document.getElementById('generateBtn');
      const previewDiv = document.getElementById('preview');

      // Business name suggestions by type
      const businessNameSuggestions = {
        bakery: ['Sweet Dreams Bakery', 'Golden Crust', 'Artisan Loaf', 'Sugar & Spice', 'The Daily Bread', 'Flour Power', 'Crust & Crumb', 'Baked Bliss'],
        hairdresser: ['Shear Elegance', 'Cut & Style', 'The Hair Studio', 'Locks & Layers', 'Style & Shine', 'Hair Haven', 'Chic Cuts', 'The Salon'],
        plumber: ['Flow Masters', 'Pipe Pros', 'Aqua Fix', 'Drip Stop', 'Plumb Perfect', 'Water Works', 'Reliable Pipes', 'Fix It Fast'],
        electrician: ['Bright Sparks', 'Current Solutions', 'Power Up', 'Wired Right', 'Electric Experts', 'Volt Pro', 'Circuit Masters', 'Shock Free'],
        restaurant: ['The Corner Bistro', 'Flavor Fusion', 'Table & Taste', 'The Local Kitchen', 'Savory & Sweet', 'Dine & Delight', 'Culinary Craft', 'The Foodie'],
        fitness: ['Fit Zone', 'Strength Studio', 'Power Gym', 'Active Life', 'Fit Force', 'Body Works', 'Muscle Up', 'The Fitness Hub'],
        photography: ['Frame & Focus', 'Capture Moments', 'Lens & Light', 'Photo Art', 'Shutter Studio', 'Picture Perfect', 'Visual Story', 'The Lens'],
        consulting: ['Strategic Edge', 'Business Boost', 'Consult Pro', 'Smart Solutions', 'Expert Advice', 'Growth Partners', 'The Advisor', 'Insight Consulting'],
        retail: ['The Shop', 'Retail Realm', 'Market Place', 'Store & More', 'The Boutique', 'Retail Rendezvous', 'Shop Smart', 'The Storefront'],
        cleaning: ['Sparkle Clean', 'Spotless Service', 'Clean & Shine', 'Fresh Start', 'Tidy Team', 'Pure Clean', 'Shine Bright', 'The Cleaners'],
        landscaping: ['Green Thumb', 'Garden Masters', 'Lawn & Order', 'Nature\'s Best', 'Garden Design', 'Landscape Pro', 'Outdoor Art', 'The Gardeners'],
        automotive: ['Auto Care', 'Drive Right', 'Car Care Pro', 'Motor Masters', 'Auto Fix', 'Wheel Works', 'Garage Pro', 'The Mechanic'],
        'real-estate': ['Home Finders', 'Property Pro', 'Real Estate Plus', 'Home Base', 'Property Partners', 'The Realtors', 'Home Solutions', 'Estate Experts'],
        tech: ['Tech Solutions', 'Code & Create', 'Digital Dynamics', 'Tech Pro', 'Innovate Now', 'Byte Works', 'Tech Hub', 'The Developers'],
        healthcare: ['Health First', 'Care Plus', 'Wellness Center', 'Health Hub', 'Care Clinic', 'Wellness Pro', 'Health Care', 'The Clinic'],
        education: ['Learn & Grow', 'Knowledge Hub', 'Study Smart', 'Edu Pro', 'Learning Lab', 'Teach & Learn', 'Education Plus', 'The Academy'],
      };

      // Generate business name suggestions
      function generateSuggestions(businessType) {
        if (!businessType || !businessNameSuggestions[businessType]) {
          return [];
        }

        const baseSuggestions = businessNameSuggestions[businessType];
        const suggestions = [...baseSuggestions];
        
        // Add some variations
        const prefixes = ['Elite', 'Premium', 'Pro', 'Prime', 'Ultimate', 'Super'];
        const suffixes = ['Co', 'Group', 'Services', 'Solutions', 'Plus', 'Pro'];
        
        // Add a few random variations
        const randomPrefix = prefixes[Math.floor(Math.random() * prefixes.length)];
        const randomSuffix = suffixes[Math.floor(Math.random() * suffixes.length)];
        const baseName = baseSuggestions[0].split(' ')[0];
        
        suggestions.push(`${randomPrefix} ${baseName}`);
        suggestions.push(`${baseName} ${randomSuffix}`);
        
        // Shuffle and return 8 suggestions
        return suggestions.sort(() => Math.random() - 0.5).slice(0, 8);
      }

      // Display suggestions
      function displaySuggestions(suggestions) {
        if (suggestions.length === 0) {
          suggestionsDiv.style.display = 'none';
          return;
        }

        suggestionsDiv.innerHTML = `
          <div class="suggestions-label">Click a suggestion to use it:</div>
          <div class="suggestions-container">
            ${suggestions.map(name => 
              `<div class="suggestion-chip" data-name="${name}">${name}</div>`
            ).join('')}
          </div>
        `;
        suggestionsDiv.style.display = 'block';

        // Add click handlers
        suggestionsDiv.querySelectorAll('.suggestion-chip').forEach(chip => {
          chip.addEventListener('click', () => {
            nameInput.value = chip.dataset.name;
            suggestionsDiv.style.display = 'none';
          });
        });
      }

      // Tagline suggestions by business type
      const taglineSuggestions = {
        bakery: ['Fresh baked daily', 'Where tradition meets taste', 'Artisan breads & pastries', 'Sweet moments, every day', 'Baked with love', 'Your neighborhood bakery', 'Quality ingredients, quality taste', 'From our oven to your table'],
        hairdresser: ['Your style, our passion', 'Where beauty begins', 'Cut, color, confidence', 'Styling your best look', 'Expert cuts, expert care', 'Your hair, our art', 'Transform your style', 'Beauty redefined'],
        plumber: ['Reliable service, guaranteed', 'Your trusted plumbing experts', 'Fast, friendly, professional', '24/7 emergency service', 'Quality work, fair prices', 'We fix it right the first time', 'Your local plumbing pros', 'Drains, pipes, and more'],
        electrician: ['Powering your home safely', 'Licensed & insured', 'Expert electrical solutions', 'Your trusted electricians', 'Safe, reliable, professional', 'Brightening your world', 'Electrical excellence', 'Wired for success'],
        restaurant: ['Fresh ingredients, bold flavors', 'Where food meets passion', 'A taste of home', 'Locally sourced, globally inspired', 'Dining reimagined', 'Your neighborhood favorite', 'Culinary excellence', 'Flavors that bring people together'],
        fitness: ['Transform your body, transform your life', 'Your fitness journey starts here', 'Stronger every day', 'Train hard, live strong', 'Where goals become reality', 'Your personal fitness partner', 'Empower your potential', 'Fitness that fits you'],
        photography: ['Capturing life\'s precious moments', 'Your story, beautifully told', 'Memories that last forever', 'Professional photography services', 'Every picture tells a story', 'Preserving your special day', 'Artistic vision, timeless results', 'Where moments become memories'],
        consulting: ['Strategic solutions for growth', 'Your business success partner', 'Expert advice, proven results', 'Transforming businesses', 'Strategic thinking, actionable results', 'Your competitive advantage', 'Growth through expertise', 'Business solutions that work'],
        retail: ['Quality products, great prices', 'Your one-stop shop', 'Shop local, shop smart', 'Everything you need', 'Quality you can trust', 'Your favorite store', 'Shop with confidence', 'More than just a store'],
        cleaning: ['Spotless results, every time', 'Your home, professionally cleaned', 'Cleaning you can trust', 'Fresh, clean, healthy', 'Professional cleaning services', 'Making your space shine', 'Clean homes, happy families', 'Your cleaning experts'],
        landscaping: ['Transforming outdoor spaces', 'Your landscape design experts', 'Beautiful gardens, beautiful homes', 'Outdoor living reimagined', 'Creating your perfect outdoor space', 'Landscaping excellence', 'Nature meets design', 'Your outdoor oasis'],
        automotive: ['Your trusted auto care experts', 'Quality service, fair prices', 'Keeping you on the road', 'Expert mechanics, honest service', 'Auto repair you can trust', 'Your car care specialists', 'Professional auto service', 'Drive with confidence'],
        'real-estate': ['Finding your perfect home', 'Your real estate experts', 'Homes, dreams, reality', 'Expert guidance, proven results', 'Your property partners', 'Real estate made simple', 'Where dreams become addresses', 'Your home buying experts'],
        tech: ['Innovative solutions for modern business', 'Technology that works for you', 'Digital transformation experts', 'Your tech partners', 'Building the future, today', 'Tech solutions that scale', 'Innovation meets execution', 'Your digital advantage'],
        healthcare: ['Caring for your health', 'Your wellness partners', 'Quality healthcare, close to home', 'Health and wellness experts', 'Caring professionals, quality care', 'Your health, our priority', 'Wellness that works', 'Healthcare you can trust'],
        education: ['Empowering minds, shaping futures', 'Learning made personal', 'Your educational partners', 'Knowledge that transforms', 'Expert tutoring, proven results', 'Unlocking potential', 'Education excellence', 'Your learning journey starts here'],
      };

      // Generate tagline suggestions
      function generateTaglineSuggestions(businessType, businessName) {
        if (!businessType || !taglineSuggestions[businessType]) {
          return [];
        }
        const baseSuggestions = taglineSuggestions[businessType];
        const suggestions = [...baseSuggestions];
        
        // Add personalized suggestions if business name is provided
        if (businessName) {
          const nameWords = businessName.split(' ')[0];
          suggestions.push(`${nameWords} - Quality you can trust`);
          suggestions.push(`Welcome to ${businessName}`);
        }
        
        return suggestions.sort(() => Math.random() - 0.5).slice(0, 8);
      }

      // Display tagline suggestions
      function displayTaglineSuggestions(suggestions) {
        if (suggestions.length === 0) {
          taglineSuggestionsDiv.style.display = 'none';
          return;
        }

        taglineSuggestionsDiv.innerHTML = `
          <div class="suggestions-label" data-i18n="form.suggestionsLabel">Click a suggestion to use it:</div>
          <div class="suggestions-container">
            ${suggestions.map(tagline => 
              `<div class="suggestion-chip" data-tagline="${tagline}">${tagline}</div>`
            ).join('')}
          </div>
        `;
        // Update translations for dynamically added content
        window.i18n.updateTranslations();
        taglineSuggestionsDiv.style.display = 'block';

        taglineSuggestionsDiv.querySelectorAll('.suggestion-chip').forEach(chip => {
          chip.addEventListener('click', () => {
            taglineInput.value = chip.dataset.tagline;
            taglineSuggestionsDiv.style.display = 'none';
          });
        });
      }

      // Suggest button handler
      suggestBtn.addEventListener('click', () => {
        const businessType = businessTypeSelect.value;
        if (!businessType) {
          alert(window.i18n.t('error.pleaseSelectBusinessType'));
          return;
        }
        const suggestions = generateSuggestions(businessType);
        displaySuggestions(suggestions);
      });

      // Tagline suggest button handler
      suggestTaglineBtn.addEventListener('click', () => {
        const businessType = businessTypeSelect.value;
        const businessName = nameInput.value.trim();
        if (!businessType) {
          alert(window.i18n.t('error.pleaseSelectBusinessType'));
          return;
        }
        const suggestions = generateTaglineSuggestions(businessType, businessName);
        displayTaglineSuggestions(suggestions);
      });

      // Location detection from IP
      async function detectLocation() {
        try {
          const response = await fetch('/api/location');
          const data = await response.json();
          if (data.location) {
            locationInput.value = data.location;
            locationInput.placeholder = window.i18n.t('form.locationPlaceholderAlt');
          } else {
            locationInput.placeholder = window.i18n.t('form.locationPlaceholderAlt');
          }
        } catch (err) {
          console.error('Location detection failed:', err);
          locationInput.placeholder = window.i18n.t('form.locationPlaceholderAlt');
        }
      }

      // Playbook button handler
      createPlaybookBtn.addEventListener('click', () => {
        const businessName = nameInput.value.trim();
        const businessType = businessTypeSelect.value;
        const location = locationInput.value.trim();
        
        if (!businessName) {
          alert('Please enter a business name first.');
          return;
        }

        const playbookData = {
          businessName,
          businessType: businessType || 'general',
          location: location || 'Unknown',
          tagline: taglineInput.value.trim() || '',
        };

        // Store playbook data and show message
        localStorage.setItem('playbookData', JSON.stringify(playbookData));
        alert(`Digital playbook will be created for ${businessName}!\n\nThis feature will generate:\n- Business plan outline\n- Marketing strategy\n- Digital presence checklist\n- Local market insights\n\n(Feature coming soon!)`);
      });

      // Progress indicator management
      function updateProgress(step) {
        document.querySelectorAll('.progress-step').forEach((el, index) => {
          const stepNum = index + 1;
          el.classList.remove('active', 'completed');
          if (stepNum < step) {
            el.classList.add('completed');
          } else if (stepNum === step) {
            el.classList.add('active');
          }
        });
      }

      // Update progress based on form interaction
      businessTypeSelect.addEventListener('change', () => {
        if (businessTypeSelect.value && nameInput.value.trim()) {
          updateProgress(2);
        }
      });

      nameInput.addEventListener('input', () => {
        if (nameInput.value.trim() && businessTypeSelect.value) {
          updateProgress(2);
        }
      });

      styleSelect.addEventListener('change', () => {
        if (nameInput.value.trim()) {
          updateProgress(2);
        }
      });

      // Icon picker functionality
      iconPickerBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        iconPickerModal.classList.toggle('active');
      });

      // Close icon picker when clicking outside
      document.addEventListener('click', (e) => {
        if (!iconPickerModal.contains(e.target) && e.target !== iconPickerBtn) {
          iconPickerModal.classList.remove('active');
        }
      });

      // Handle icon selection
      iconPickerModal.querySelectorAll('.icon-option').forEach(option => {
        option.addEventListener('click', () => {
          const selectedIcon = option.dataset.icon;
          iconInput.value = selectedIcon;
          
          // Update visual selection
          iconPickerModal.querySelectorAll('.icon-option').forEach(opt => {
            opt.classList.remove('selected');
          });
          option.classList.add('selected');
          
          // Close modal after a short delay
          setTimeout(() => {
            iconPickerModal.classList.remove('active');
          }, 300);
        });
      });

      // Update selected icon visual when input changes
      iconInput.addEventListener('input', () => {
        const currentIcon = iconInput.value;
        iconPickerModal.querySelectorAll('.icon-option').forEach(option => {
          option.classList.remove('selected');
          if (option.dataset.icon === currentIcon) {
            option.classList.add('selected');
          }
        });
      });

      // Auto-suggest icons based on business type
      businessTypeSelect.addEventListener('change', () => {
        const businessType = businessTypeSelect.value;
        const iconSuggestions = {
          bakery: 'üç∞',
          hairdresser: 'üíá',
          plumber: 'üîß',
          electrician: '‚ö°',
          restaurant: '‚òï',
          fitness: 'üèãÔ∏è',
          photography: 'üì∏',
          consulting: 'üíº',
          retail: 'üõçÔ∏è',
          cleaning: '‚ú®',
          landscaping: 'üåø',
          automotive: 'üöó',
          'real-estate': 'üè†',
          tech: 'üíª',
          healthcare: 'üíö',
          education: 'üìö',
        };
        
        if (iconSuggestions[businessType] && !iconInput.value) {
          iconInput.value = iconSuggestions[businessType];
        }
      });

      // Detect location on page load
      detectLocation();

      // Color palette definitions
      const colorPalettes = {
        warm: { font: '#8B4513', bg: '#FFF8DC' },
        cold: { font: '#1E3A8A', bg: '#E0F2FE' },
        earthy: { font: '#5D4037', bg: '#EFEBE9' },
        bold: { font: '#FFFFFF', bg: '#E91E63' },
        pastel: { font: '#6A5ACD', bg: '#F8BBD0' },
        monochrome: { font: '#212121', bg: '#FFFFFF' },
      };

      // Update colors when palette changes
      colorPaletteSelect.addEventListener('change', () => {
        const palette = colorPaletteSelect.value;
        if (palette === 'custom') {
          colorPickersDiv.style.display = 'block';
        } else {
          colorPickersDiv.style.display = 'block';
          const colors = colorPalettes[palette];
          if (colors) {
            fontColorInp.value = colors.font;
            bgColorInp.value = colors.bg;
          }
        }
      });

      async function generateLogo() {
        // Check authentication first
        if (!currentUser) {
          showAuthGate();
          return;
        }

        const name = nameInput.value.trim();
        const tagline = taglineInput.value.trim();
        const style = styleSelect.value.toLowerCase();
        const fontCategory = fontCategorySelect.value.toLowerCase();
        const icon = iconInput.value.trim();
        const layout = layoutSelect.value.toLowerCase();
        const shape = shapeSelect.value.toLowerCase();
        const colorPalette = colorPaletteSelect.value;
        let fontColor = fontColorInp.value;
        let bgColor = bgColorInp.value;

        // Apply color palette if not custom
        if (colorPalette !== 'custom' && colorPalettes[colorPalette]) {
          fontColor = colorPalettes[colorPalette].font;
          bgColor = colorPalettes[colorPalette].bg;
        }

        if (!name) {
          alert(window.i18n.t('error.pleaseEnterBusinessName'));
          return;
        }

        btn.disabled = true;
        btn.textContent = window.i18n.t('form.generating');
        previewDiv.innerHTML = `<div class="preview-placeholder" data-i18n="preview.generating">${window.i18n.t('preview.generating')}</div>`;

        const payload = {
          name,
          tagline: tagline || undefined,
          style,
          fontCategory,
          icon: icon || undefined,
          layout,
          shape,
          fontColor,
          bgColor,
        };

        console.log('üõ∞Ô∏è Sending generate-logo:', payload);

        try {
          const res = await fetch('/generate-logo', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload),
          });
          if (!res.ok) throw new Error(await res.text());
          const { svgPath, pngPath } = await res.json();

          console.log('‚úÖ Logo paths:', svgPath, pngPath);
          
          // Update progress to step 3
          updateProgress(3);
          
          // Store logo paths for favicon generation
          window.generatedLogoPaths = { svgPath, pngPath };
          
          previewDiv.innerHTML = `
            <img src="${pngPath}" alt="Logo Preview (PNG)" />
            <div class="downloads">
              <a href="${svgPath}" download data-i18n="preview.downloadSvg">${window.i18n.t('preview.downloadSvg')}</a>
              <a href="${pngPath}" download data-i18n="preview.downloadPng">${window.i18n.t('preview.downloadPng')}</a>
            </div>
            <div class="format-info">
              <strong data-i18n="preview.formatGuide">${window.i18n.t('preview.formatGuide')}</strong><br>
              <strong>SVG</strong> - <span data-i18n="preview.svgDescription">${window.i18n.t('preview.svgDescription')}</span><br>
              <strong>PNG</strong> - <span data-i18n="preview.pngDescription">${window.i18n.t('preview.pngDescription')}</span>
            </div>
            <div class="trust-badge">
              <span>‚úì</span> <span data-i18n="preview.usageRights">${window.i18n.t('preview.usageRights')}</span>
            </div>
          `;
          // Update translations for dynamically added content
          window.i18n.updateTranslations();
          
          // Show favicon section after logo is generated
          setTimeout(() => {
            showFaviconSection();
          }, 500);
        } catch (err) {
          console.error('‚ùå Generation error:', err);
          previewDiv.innerHTML = `<div class="preview-placeholder error" data-i18n="preview.error">${window.i18n.t('preview.error')}</div>`;
        } finally {
          btn.disabled = false;
          btn.textContent = window.i18n.t('form.generateLogo');
        }
      }

      btn.addEventListener('click', () => {
        console.log('üîò Generate button clicked');
        generateLogo();
      });

      // Favicon generation
      const faviconSection = document.getElementById('faviconSection');
      const faviconUseLogoSection = document.getElementById('faviconUseLogoSection');
      const faviconLogoPreview = document.getElementById('faviconLogoPreview');
      const useLogoForFaviconBtn = document.getElementById('useLogoForFaviconBtn');
      const faviconAutoOptions = document.getElementById('faviconAutoOptions');
      const generateAutoFaviconBtn = document.getElementById('generateAutoFaviconBtn');
      const faviconManualSection = document.getElementById('faviconManualSection');
      const toggleManualFaviconBtn = document.getElementById('toggleManualFaviconBtn');
      const faviconTextInput = document.getElementById('faviconText');
      const faviconStyleSelect = document.getElementById('faviconStyle');
      const faviconFontCategorySelect = document.getElementById('faviconFontCategory');
      const faviconShapeSelect = document.getElementById('faviconShape');
      const faviconFontColorInput = document.getElementById('faviconFontColor');
      const faviconBgColorInput = document.getElementById('faviconBgColor');
      const generateFaviconBtn = document.getElementById('generateFaviconBtn');
      const faviconPreviewSection = document.getElementById('faviconPreviewSection');
      const faviconPreview = document.getElementById('faviconPreview');
      const faviconHtmlCode = document.getElementById('faviconHtmlCode');
      const downloadAllFaviconsBtn = document.getElementById('downloadAllFaviconsBtn');

      // Show favicon section after logo is generated
      function showFaviconSection() {
        if (!faviconSection) return;
        faviconSection.style.display = 'block';
        updateProgress(4);
        
        // Scroll to favicon section
        setTimeout(() => {
          faviconSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
        
        // Show "use logo" option if logo was generated
        if (window.generatedLogoPaths && window.generatedLogoPaths.pngPath && faviconUseLogoSection) {
          faviconUseLogoSection.style.display = 'block';
          if (faviconLogoPreview) {
            faviconLogoPreview.innerHTML = `<img src="${window.generatedLogoPaths.pngPath}" alt="Logo" style="width: 100%; height: 100%; object-fit: contain;" />`;
          }
        }
      }

      // Auto-generate favicon options based on business info
      function generateAutoFaviconOptions() {
        // Check authentication first
        if (!currentUser) {
          showAuthGate();
          return;
        }

        const businessName = nameInput.value.trim();
        const businessType = businessTypeSelect.value;
        
        if (!businessName) {
          alert(window.i18n.t('error.pleaseEnterBusinessName'));
          return;
        }

        // Get first 1-2 letters of business name
        const initials = businessName.substring(0, 2).toUpperCase();
        const firstLetter = businessName.substring(0, 1).toUpperCase();
        
        // Generate creative options
        const options = [
          {
            text: firstLetter,
            style: 'minimal',
            shape: 'circle',
            fontCategory: 'bold',
            fontColor: '#ffffff',
            bgColor: '#10a37f',
            name: 'Minimal Circle'
          },
          {
            text: initials,
            style: 'flat',
            shape: 'square',
            fontCategory: 'modern',
            fontColor: '#ffffff',
            bgColor: '#1a1a1a',
            name: 'Modern Square'
          },
          {
            text: firstLetter,
            style: 'gradient',
            shape: 'rounded',
            fontCategory: 'elegant',
            fontColor: '#ffffff',
            bgColor: '#6366f1',
            name: 'Elegant Gradient'
          },
          {
            text: initials,
            style: 'outline',
            shape: 'circle',
            fontCategory: 'bold',
            fontColor: '#10a37f',
            bgColor: 'transparent',
            name: 'Bold Outline'
          }
        ];

        // Display options
        if (faviconAutoOptions) {
          faviconAutoOptions.innerHTML = options.map((option, index) => `
            <div style="background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px; text-align: center; cursor: pointer; transition: all 0.2s;" 
                 class="favicon-option" 
                 data-option-index="${index}"
                 onmouseover="this.style.borderColor='#10a37f'" 
                 onmouseout="this.style.borderColor='#2a2a2a'">
              <div style="width: 64px; height: 64px; margin: 0 auto 12px; border-radius: ${option.shape === 'circle' ? '50%' : option.shape === 'rounded' ? '12px' : '4px'}; background: ${option.bgColor === 'transparent' ? '#0d0d0d' : option.bgColor}; display: flex; align-items: center; justify-content: center; border: ${option.bgColor === 'transparent' ? '2px solid ' + option.fontColor : 'none'};">
                <span style="color: ${option.fontColor}; font-size: 32px; font-weight: 600;">${option.text}</span>
              </div>
              <div style="font-size: 12px; color: #ececec; font-weight: 500;">${option.name}</div>
            </div>
          `).join('');

          // Store options for later use
          window.faviconAutoOptions = options;

          // Add click handlers
          faviconAutoOptions.querySelectorAll('.favicon-option').forEach((el, index) => {
            el.addEventListener('click', () => {
              const option = options[index];
              generateFaviconFromOption(option);
            });
          });
        }
      }

      // Generate favicon from auto option
      async function generateFaviconFromOption(option) {
        if (faviconTextInput) faviconTextInput.value = option.text;
        if (faviconStyleSelect) faviconStyleSelect.value = option.style;
        if (faviconShapeSelect) faviconShapeSelect.value = option.shape;
        if (faviconFontCategorySelect) faviconFontCategorySelect.value = option.fontCategory;
        if (faviconFontColorInput) faviconFontColorInput.value = option.fontColor;
        if (faviconBgColorInput) faviconBgColorInput.value = option.bgColor === 'transparent' ? '#000000' : option.bgColor;
        
        // Generate the favicon
        await generateFavicon();
      }

      // Use logo for favicon
      async function useLogoForFavicon() {
        // Check authentication first
        if (!currentUser) {
          showAuthGate();
          return;
        }

        if (!window.generatedLogoPaths || !window.generatedLogoPaths.pngPath) {
          alert('Please generate a logo first');
          return;
        }

        if (useLogoForFaviconBtn) {
          useLogoForFaviconBtn.disabled = true;
          useLogoForFaviconBtn.textContent = window.i18n.t('form.generating');
        }
        if (faviconPreviewSection) faviconPreviewSection.style.display = 'none';

        try {
          const res = await fetch('/generate-favicon-from-logo', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              logoPath: window.generatedLogoPaths.pngPath
            }),
            credentials: 'include',
          });

          if (!res.ok) {
            throw new Error(await res.text());
          }

          const { files } = await res.json();
          displayFaviconResults(files);
        } catch (err) {
          console.error('‚ùå Error generating favicon from logo:', err);
          alert(window.i18n.t('favicon.error.generationFailed'));
        } finally {
          if (useLogoForFaviconBtn) {
            useLogoForFaviconBtn.disabled = false;
            useLogoForFaviconBtn.textContent = window.i18n.t('favicon.useLogo.button');
          }
        }
      }

      // Display favicon results
      function displayFaviconResults(files) {
        if (!faviconPreview) return;
        
        const faviconSizes = [
          { key: 'favicon-16x16', label: '16√ó16', desc: 'Standard favicon' },
          { key: 'favicon-32x32', label: '32√ó32', desc: 'Standard favicon' },
          { key: 'favicon-48x48', label: '48√ó48', desc: 'Standard favicon' },
          { key: 'apple-touch-icon', label: '180√ó180', desc: 'Apple touch icon' },
          { key: 'android-chrome-192x192', label: '192√ó192', desc: 'Android Chrome' },
          { key: 'android-chrome-512x512', label: '512√ó512', desc: 'Android Chrome' },
        ];

        faviconPreview.innerHTML = faviconSizes
          .filter(size => files[size.key])
          .map(size => {
            const file = files[size.key];
            return `
              <div style="background: #1f1f1f; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px; text-align: center;">
                <div style="margin-bottom: 12px;">
                  <img src="${file.png}" alt="${size.label}" style="width: 64px; height: 64px; image-rendering: pixelated; border: 1px solid #2a2a2a; border-radius: 4px;" />
                </div>
                <div style="font-size: 13px; font-weight: 600; color: #ececec; margin-bottom: 4px;">${size.label}</div>
                <div style="font-size: 11px; color: #8e8e93; margin-bottom: 12px;">${size.desc}</div>
                <div style="display: flex; gap: 8px; justify-content: center;">
                  <a href="${file.png}" download="${size.key}.png" style="padding: 6px 12px; background: #10a37f; color: #fff; border-radius: 4px; font-size: 12px; text-decoration: none;">PNG</a>
                  <a href="${file.svg}" download="${size.key}.svg" style="padding: 6px 12px; background: #1f1f1f; border: 1px solid #2a2a2a; color: #ececec; border-radius: 4px; font-size: 12px; text-decoration: none;">SVG</a>
                </div>
              </div>
            `;
          })
          .join('');

        // Generate HTML code
        const baseUrl = window.location.origin;
        const htmlCode = `<!-- Favicon -->
<link rel="icon" type="image/png" sizes="16x16" href="${baseUrl}${files['favicon-16x16']?.png || ''}">
<link rel="icon" type="image/png" sizes="32x32" href="${baseUrl}${files['favicon-32x32']?.png || ''}">
<link rel="icon" type="image/png" sizes="48x48" href="${baseUrl}${files['favicon-48x48']?.png || ''}">
<link rel="apple-touch-icon" sizes="180x180" href="${baseUrl}${files['apple-touch-icon']?.png || ''}">
<link rel="icon" type="image/png" sizes="192x192" href="${baseUrl}${files['android-chrome-192x192']?.png || ''}">
<link rel="icon" type="image/png" sizes="512x512" href="${baseUrl}${files['android-chrome-512x512']?.png || ''}">`;

        if (faviconHtmlCode) faviconHtmlCode.textContent = htmlCode;
        if (faviconPreviewSection) faviconPreviewSection.style.display = 'block';
        window.i18n.updateTranslations();
      }

      async function generateFavicon() {
        // Check authentication first
        if (!currentUser) {
          showAuthGate();
          return;
        }

        const text = faviconTextInput.value.trim().toUpperCase();
        const fontCategory = faviconFontCategorySelect.value.toLowerCase();
        const shape = faviconShapeSelect.value.toLowerCase();
        const fontColor = faviconFontColorInput.value;
        const bgColor = faviconBgColorInput.value;

        if (!text || text.length === 0) {
          alert(window.i18n.t('favicon.error.noText'));
          return;
        }

        if (text.length > 2) {
          alert(window.i18n.t('favicon.error.tooLong'));
          return;
        }

        if (generateFaviconBtn) {
          generateFaviconBtn.disabled = true;
          generateFaviconBtn.textContent = window.i18n.t('form.generating');
        }
        if (faviconPreviewSection) faviconPreviewSection.style.display = 'none';

        const payload = {
          text,
          fontCategory,
          shape,
          fontColor,
          bgColor,
          style,
        };

        console.log('üõ∞Ô∏è Sending generate-favicon:', payload);

        try {
          const res = await fetch('/generate-favicon', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload),
            credentials: 'include',
          });
          if (!res.ok) {
            const errorText = await res.text();
            throw new Error(errorText);
          }
          const { files } = await res.json();

          console.log('‚úÖ Favicon files:', files);
          displayFaviconResults(files);
          
          // Show favicon section and scroll to it
          showFaviconSection();
        } catch (err) {
          console.error('‚ùå Favicon generation error:', err);
          alert(window.i18n.t('favicon.error.generationFailed'));
        } finally {
          if (generateFaviconBtn) {
            generateFaviconBtn.disabled = false;
            generateFaviconBtn.textContent = window.i18n.t('favicon.generate');
          }
        }
      }

      if (generateFaviconBtn) {
        generateFaviconBtn.addEventListener('click', () => {
          console.log('üîò Generate favicon button clicked');
          generateFavicon();
        });
      }

      // Event handlers for new favicon features
      if (useLogoForFaviconBtn) {
        useLogoForFaviconBtn.addEventListener('click', useLogoForFavicon);
      }
      if (generateAutoFaviconBtn) {
        generateAutoFaviconBtn.addEventListener('click', generateAutoFaviconOptions);
      }
      if (toggleManualFaviconBtn && faviconManualSection) {
        toggleManualFaviconBtn.addEventListener('click', () => {
          faviconManualSection.style.display = faviconManualSection.style.display === 'none' ? 'block' : 'none';
          toggleManualFaviconBtn.textContent = faviconManualSection.style.display === 'none' 
            ? window.i18n.t('favicon.manual.toggle') 
            : window.i18n.t('favicon.manual.hide');
        });
      }

      // Close auth gate when clicking outside
      document.addEventListener('click', (e) => {
        const authGate = document.getElementById('authGate');
        if (authGate && authGate.classList.contains('active') && e.target === authGate) {
          window.closeAuthGate();
        }
      });

      window.addEventListener('DOMContentLoaded', async () => {
        // Ensure homepage is visible and logo generator is hidden by default
        const homepage = document.getElementById('homepage');
        const logoGenerator = document.getElementById('logoGenerator');
        
        console.log('üîç DOMContentLoaded - Elements check:', {
          homepage: !!homepage,
          logoGenerator: !!logoGenerator,
          homepageDisplay: homepage?.style.display,
          logoGeneratorDisplay: logoGenerator?.style.display
        });
        
        if (homepage) {
          homepage.style.display = 'block';
          console.log('‚úÖ Set homepage to block');
        } else {
          console.error('‚ùå Homepage element not found!');
        }
        
        if (logoGenerator) {
          logoGenerator.style.display = 'none';
          console.log('‚úÖ Set logoGenerator to none');
        } else {
          console.error('‚ùå LogoGenerator element not found!');
        }
        
        // Add event listeners to buttons (using event listeners instead of onclick)
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        const heroSignupBtn = document.getElementById('heroSignupBtn');
        const heroLoginBtn = document.getElementById('heroLoginBtn');
        const allToolsBtn = document.getElementById('allToolsBtn');
        
        if (loginBtn) {
          loginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('üîµ Login button clicked via event listener');
            if (typeof window.openLoginModal === 'function') {
              window.openLoginModal();
            } else {
              console.error('‚ùå window.openLoginModal is not a function!');
            }
          });
          console.log('‚úÖ Added event listener to login button');
        } else {
          console.error('‚ùå Login button not found!');
        }
        
        if (signupBtn) {
          signupBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('üü¢ Signup button clicked via event listener');
            if (typeof window.openSignupModal === 'function') {
              window.openSignupModal();
            } else {
              console.error('‚ùå window.openSignupModal is not a function!');
            }
          });
          console.log('‚úÖ Added event listener to signup button');
        } else {
          console.error('‚ùå Signup button not found!');
        }
        
        if (heroSignupBtn) {
          heroSignupBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('üü¢ Hero signup button clicked');
            if (typeof window.openSignupModal === 'function') {
              window.openSignupModal();
            }
          });
          console.log('‚úÖ Added event listener to hero signup button');
        }
        
        if (heroLoginBtn) {
          heroLoginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('üîµ Hero login button clicked');
            if (typeof window.openLoginModal === 'function') {
              window.openLoginModal();
            }
          });
          console.log('‚úÖ Added event listener to hero login button');
        }
        
        if (allToolsBtn) {
          allToolsBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('üü¢ All tools button clicked');
            if (typeof window.openSignupModal === 'function') {
              window.openSignupModal();
            }
          });
          console.log('‚úÖ Added event listener to all tools button');
        }
        
        // Add event listeners to tool cards
        document.querySelectorAll('[data-tool-card="true"]').forEach(card => {
          card.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('üü° Tool card clicked');
            if (typeof window.showAuthGate === 'function') {
              window.showAuthGate();
            }
          });
        });
        console.log(`‚úÖ Added event listeners to ${document.querySelectorAll('[data-tool-card="true"]').length} tool cards`);
        
        // Initialize i18n first
        await window.i18n.init();
        
        // Force update translations after a short delay to ensure DOM is ready
        setTimeout(() => {
          window.i18n.updateTranslations();
        }, 200);
        
        // Also update translations after auth check (homepage might be shown)
        setTimeout(() => {
          window.i18n.updateTranslations();
        }, 500);
        
        // Update language selector to current language
        const langSelector = document.getElementById('languageSelector');
        if (langSelector) {
          langSelector.value = window.i18n.getCurrentLanguage();
          langSelector.addEventListener('change', async (e) => {
            await window.i18n.setLanguage(e.target.value);
          });
        }
        
        const params = new URLSearchParams(location.search);
        const n = params.get('name');
        if (n) {
          nameInput.value = n;
          setTimeout(generateLogo, 100);
        }
        
        // Check authentication status on load
        checkAuthStatus();
        
        // Check for OAuth callback success
        if (params.get('auth_success') === 'true') {
          checkAuthStatus();
          // Remove query param
          window.history.replaceState({}, document.title, window.location.pathname);
        }
      });

      // Authentication functions
      let currentUser = null;

      async function checkAuthStatus() {
        try {
          const response = await fetch('/auth/me');
          if (response.ok) {
            const data = await response.json();
            currentUser = data.user;
            updateAuthUI(data.user);
            loadUsageLimits();
            loadAds();
          } else {
            currentUser = null;
            updateAuthUI(null);
            hideAds();
          }
        } catch (err) {
          console.error('Auth check error:', err);
          currentUser = null;
          updateAuthUI(null);
        }
      }

      function updateAuthUI(user) {
        console.log('üîÑ updateAuthUI called with user:', user ? 'authenticated' : 'not authenticated');
        const authButtons = document.getElementById('authButtons');
        const userInfo = document.getElementById('userInfo');
        const homepage = document.getElementById('homepage');
        const logoGenerator = document.getElementById('logoGenerator');
        
        console.log('üì¶ Elements found:', {
          homepage: !!homepage,
          logoGenerator: !!logoGenerator,
          authButtons: !!authButtons,
          userInfo: !!userInfo
        });
        
        if (user) {
          authButtons.style.display = 'none';
          userInfo.style.display = 'flex';
          document.getElementById('userName').textContent = user.name || user.email;
          document.getElementById('userAvatar').textContent = (user.name || user.email || 'U')[0].toUpperCase();
          if (user.avatarUrl) {
            document.getElementById('userAvatar').style.backgroundImage = `url(${user.avatarUrl})`;
            document.getElementById('userAvatar').style.backgroundSize = 'cover';
          }
          // Update language selector to current language
          const langSelector = document.getElementById('languageSelector');
          if (langSelector) {
            langSelector.value = window.i18n.getCurrentLanguage();
          }
          
          // Show logo generator, hide homepage
          if (homepage) {
            homepage.style.display = 'none';
            console.log('‚úÖ Hiding homepage, showing logo generator');
          }
          if (logoGenerator) {
            logoGenerator.style.display = 'block';
            console.log('‚úÖ Logo generator display set to block');
          }
          
          // Update translations for logo generator after it's shown
          setTimeout(() => {
            window.i18n.updateTranslations();
          }, 100);
        } else {
          authButtons.style.display = 'flex';
          userInfo.style.display = 'none';
          
          // Show homepage, hide logo generator
          if (homepage) {
            homepage.style.display = 'block';
            console.log('‚úÖ Homepage display set to block');
          }
          if (logoGenerator) {
            logoGenerator.style.display = 'none';
            console.log('‚úÖ Logo generator display set to none');
          }
          
          // Update translations for homepage after it's shown
          setTimeout(() => {
            window.i18n.updateTranslations();
          }, 100);
        }
      }

      async function loadUsageLimits() {
        if (!currentUser) return;
        
        try {
          const response = await fetch('/api/usage-limits');
          if (response.ok) {
            const limits = await response.json();
            const remaining = limits.remaining;
            document.getElementById('usageInfo').textContent = 
              window.i18n.t('usage.dailyRemaining', { daily: remaining.daily, hourly: remaining.hourly });
          }
        } catch (err) {
          console.error('Error loading usage limits:', err);
        }
      }

      // Modal functions are already defined at the top of the script

      // Close modals on outside click
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.classList.remove('active');
          }
        });
      });

      // Auth handlers
      async function handleLogin(event) {
        event.preventDefault();
        const errorDiv = document.getElementById('loginError');
        errorDiv.innerHTML = '';

        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;

        try {
          const response = await fetch('/auth/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password }),
            credentials: 'include',
          });

          const data = await response.json();

          if (response.ok) {
            if (data.needsVerification) {
              errorDiv.innerHTML = `<div class="success-message">${window.i18n.t('success.emailVerified')}. ${window.i18n.t('auth.forgotPassword')}</div>`;
            } else {
              closeLoginModal();
              await checkAuthStatus();
              // After successful login, logo generator will be shown via updateAuthUI
            }
          } else {
            const errorMsg = data.error || window.i18n.t('error.loginFailed');
            errorDiv.innerHTML = `<div class="error-message">${errorMsg}</div>`;
          }
        } catch (err) {
          errorDiv.innerHTML = `<div class="error-message">${window.i18n.t('error.networkError')}</div>`;
        }
      }

      async function handleSignup(event) {
        event.preventDefault();
        const errorDiv = document.getElementById('signupError');
        errorDiv.innerHTML = '';

        const name = document.getElementById('signupName').value;
        const email = document.getElementById('signupEmail').value;
        const password = document.getElementById('signupPassword').value;

        try {
          const response = await fetch('/auth/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, email, password }),
            credentials: 'include',
          });

          const data = await response.json();

          if (response.ok) {
            errorDiv.innerHTML = `<div class="success-message">${window.i18n.t('success.registrationSuccessful')}</div>`;
            // Check if user is now authenticated (OAuth users) or needs email verification
            setTimeout(async () => {
              await checkAuthStatus();
              closeSignupModal();
              // If still not authenticated, show login modal
              if (!currentUser) {
                openLoginModal();
              }
            }, 2000);
          } else {
            const errorMsg = data.error || window.i18n.t('error.registrationFailed');
            errorDiv.innerHTML = `<div class="error-message">${errorMsg}</div>`;
          }
        } catch (err) {
          errorDiv.innerHTML = `<div class="error-message">${window.i18n.t('error.networkError')}</div>`;
        }
      }

      async function handleForgotPassword(event) {
        event.preventDefault();
        const errorDiv = document.getElementById('forgotPasswordError');
        errorDiv.innerHTML = '';

        const email = document.getElementById('forgotPasswordEmail').value;

        try {
          const response = await fetch('/auth/forgot-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email }),
          });

          const data = await response.json();

          if (response.ok) {
            errorDiv.innerHTML = `<div class="success-message">${window.i18n.t('success.passwordResetSent')}</div>`;
          } else {
            const errorMsg = data.error || window.i18n.t('error.networkError');
            errorDiv.innerHTML = `<div class="error-message">${errorMsg}</div>`;
          }
        } catch (err) {
          errorDiv.innerHTML = `<div class="error-message">${window.i18n.t('error.networkError')}</div>`;
        }
      }

      async function logout() {
        try {
          await fetch('/auth/logout', {
            method: 'POST',
            credentials: 'include',
          });
          currentUser = null;
          updateAuthUI(null);
          hideAds();
          // Scroll to top after logout
          window.scrollTo({ top: 0, behavior: 'smooth' });
        } catch (err) {
          console.error('Logout error:', err);
        }
      }

      // Ad integration
      function loadAds() {
        if (!currentUser || currentUser.subscriptionTier !== 'free') {
          hideAds();
          return;
        }

        const adContainer = document.getElementById('adContainer');
        const adSenseContainer = document.getElementById('adSenseContainer');
        
        adContainer.style.display = 'block';
        
        // Google AdSense integration
        // AdSense script is already loaded in the <head> section
        const adsenseClientId = 'ca-pub-2385399270661663';

        // Create ad unit (you'll need to configure this in AdSense)
        if (!adSenseContainer.querySelector('ins')) {
          const adUnit = document.createElement('ins');
          adUnit.className = 'adsbygoogle';
          adUnit.style.display = 'block';
          adUnit.setAttribute('data-ad-client', adsenseClientId);
          adUnit.setAttribute('data-ad-slot', '1234567890'); // Replace with your ad slot
          adUnit.setAttribute('data-ad-format', 'auto');
          adUnit.setAttribute('data-full-width-responsive', 'true');
          
          adSenseContainer.innerHTML = '';
          adSenseContainer.appendChild(adUnit);
          
          // Push ad to AdSense
          if (window.adsbygoogle) {
            try {
              (window.adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
              console.error('AdSense error:', e);
            }
          }
        }
      }

      function hideAds() {
        document.getElementById('adContainer').style.display = 'none';
      }
    </script>
  </body>
</html>
